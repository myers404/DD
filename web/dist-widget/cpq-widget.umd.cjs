(function(Te,Fe){typeof exports=="object"&&typeof module<"u"?Fe(exports):typeof define=="function"&&define.amd?define(["exports"],Fe):(Te=typeof globalThis<"u"?globalThis:Te||self,Fe(Te.CPQConfigurator={}))})(this,function(Te){"use strict";var Qr=Te=>{throw TypeError(Te)};var Yr=(Te,Fe,je)=>Fe.has(Te)||Qr("Cannot "+je);var N=(Te,Fe,je)=>(Yr(Te,Fe,"read from private field"),je?je.call(Te):Fe.get(Te)),Ce=(Te,Fe,je)=>Fe.has(Te)?Qr("Cannot add the same private member more than once"):Fe instanceof WeakSet?Fe.add(Te):Fe.set(Te,je),Ie=(Te,Fe,je,li)=>(Yr(Te,Fe,"write to private field"),li?li.call(Te,je):Fe.set(Te,je),je);var Fr,Rt,Mt,Vt,Lt,Nt,zt,Ft,Ut,jt,Gt,Bt,Ht,Qt,Yt,Wt,Kt,Jt,Zt,Xt,$t,ei,ti,ii,ri;var je=Array.isArray,li=Array.prototype.indexOf,Pi=Array.from,Wr=Object.defineProperty,Ct=Object.getOwnPropertyDescriptor,Kr=Object.getOwnPropertyDescriptors,Jr=Object.prototype,Zr=Array.prototype,Zi=Object.getPrototypeOf,Xi=Object.isExtensible;const Xr=()=>{};function $r(t){for(var e=0;e<t.length;e++)t[e]()}function Di(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const i=[];for(const r of t)if(i.push(r),i.length===e)break;return i}const Xe=2,$i=4,Oi=8,qi=16,st=32,bt=64,Ri=128,Ye=256,vi=512,We=1024,at=2048,yt=4096,ot=8192,Mi=16384,er=32768,ui=65536,en=1<<19,tr=1<<20,Vi=1<<21,ci=Symbol("$state"),tn=Symbol("legacy props"),rn=Symbol("");function ir(t){return t===this.v}function nn(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Li(t){return!nn(t,this.v)}function sn(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function an(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function on(t){throw new Error("https://svelte.dev/e/effect_orphan")}function ln(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function vn(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function un(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function cn(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function dn(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let il=!1;const Ni=1,zi=2,rr=4,fn=8,_n=16,hn=1,gn=4,pn=8,mn=16,bn=1,yn=2,He=Symbol(),wn="http://www.w3.org/1999/xhtml";function Fi(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let Ge=null;function nr(t){Ge=t}function $e(t,e=!1,i){var r=Ge={p:Ge,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};Tn(()=>{r.d=!0})}function et(t){const e=Ge;if(e!==null){t!==void 0&&(e.x=t);const l=e.e;if(l!==null){var i=Se,r=we;e.e=null;try{for(var n=0;n<l.length;n++){var s=l[n];Ot(s.effect),ft(s.reaction),hr(s.fn)}}finally{Ot(i),ft(r)}}Ge=e.p,e.m=!0}return t||{}}function sr(){return!0}function Me(t){if(typeof t!="object"||t===null||ci in t)return t;const e=Zi(t);if(e!==Jr&&e!==Zr)return t;var i=new Map,r=je(t),n=H(0),s=we,l=v=>{var d=we;ft(s);var _=v();return ft(d),_};return r&&i.set("length",H(t.length)),new Proxy(t,{defineProperty(v,d,_){return(!("value"in _)||_.configurable===!1||_.enumerable===!1||_.writable===!1)&&un(),l(()=>{var S=i.get(d);S===void 0?(S=H(_.value),i.set(d,S)):z(S,_.value,!0)}),!0},deleteProperty(v,d){var _=i.get(d);if(_===void 0){if(d in v){const c=l(()=>H(He));i.set(d,c),Ui(n)}}else{if(r&&typeof d=="string"){var S=i.get("length"),b=Number(d);Number.isInteger(b)&&b<S.v&&z(S,b)}z(_,He),Ui(n)}return!0},get(v,d,_){if(d===ci)return t;var S=i.get(d),b=d in v;if(S===void 0&&(!b||Ct(v,d)?.writable)&&(S=l(()=>{var g=Me(b?v[d]:He),w=H(g);return w}),i.set(d,S)),S!==void 0){var c=o(S);return c===He?void 0:c}return Reflect.get(v,d,_)},getOwnPropertyDescriptor(v,d){var _=Reflect.getOwnPropertyDescriptor(v,d);if(_&&"value"in _){var S=i.get(d);S&&(_.value=o(S))}else if(_===void 0){var b=i.get(d),c=b?.v;if(b!==void 0&&c!==He)return{enumerable:!0,configurable:!0,value:c,writable:!0}}return _},has(v,d){if(d===ci)return!0;var _=i.get(d),S=_!==void 0&&_.v!==He||Reflect.has(v,d);if(_!==void 0||Se!==null&&(!S||Ct(v,d)?.writable)){_===void 0&&(_=l(()=>{var c=S?Me(v[d]):He,g=H(c);return g}),i.set(d,_));var b=o(_);if(b===He)return!1}return S},set(v,d,_,S){var b=i.get(d),c=d in v;if(r&&d==="length")for(var g=_;g<b.v;g+=1){var w=i.get(g+"");w!==void 0?z(w,He):g in v&&(w=l(()=>H(He)),i.set(g+"",w))}if(b===void 0)(!c||Ct(v,d)?.writable)&&(b=l(()=>{var T=H(void 0);return z(T,Me(_)),T}),i.set(d,b));else{c=b.v!==He;var O=l(()=>Me(_));z(b,O)}var M=Reflect.getOwnPropertyDescriptor(v,d);if(M?.set&&M.set.call(S,_),!c){if(r&&typeof d=="string"){var A=i.get("length"),x=Number(d);Number.isInteger(x)&&x>=A.v&&z(A,x+1)}Ui(n)}return!0},ownKeys(v){o(n);var d=Reflect.ownKeys(v).filter(b=>{var c=i.get(b);return c===void 0||c.v!==He});for(var[_,S]of i)S.v!==He&&!(_ in v)&&d.push(_);return d},setPrototypeOf(){cn()}})}function Ui(t,e=1){z(t,t.v+e)}function di(t){var e=Xe|at,i=we!==null&&(we.f&Xe)!==0?we:null;return Se===null||i!==null&&(i.f&Ye)!==0?e|=Ye:Se.f|=tr,{ctx:Ge,deps:null,effects:null,equals:ir,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:i??Se}}function me(t){const e=di(t);return xr(e),e}function Sn(t){const e=di(t);return e.equals=Li,e}function ar(t){var e=t.effects;if(e!==null){t.effects=null;for(var i=0;i<e.length;i+=1)it(e[i])}}function xn(t){for(var e=t.parent;e!==null;){if((e.f&Xe)===0)return e;e=e.parent}return null}function or(t){var e,i=Se;Ot(xn(t));try{ar(t),e=Cr(t)}finally{Ot(i)}return e}function lr(t){var e=or(t);if(t.equals(e)||(t.v=e,t.wv=Er()),!Dt){var i=(_t||(t.f&Ye)!==0)&&t.deps!==null?yt:We;tt(t,i)}}const ni=new Map;function fi(t,e){var i={f:0,v:t,reactions:null,equals:ir,rv:0,wv:0};return i}function H(t,e){const i=fi(t);return xr(i),i}function vr(t,e=!1,i=!0){const r=fi(t);return e||(r.equals=Li),r}function z(t,e,i=!1){we!==null&&!rt&&sr()&&(we.f&(Xe|qi))!==0&&!lt?.includes(t)&&dn();let r=i?Me(e):e;return ji(t,r)}function ji(t,e){if(!t.equals(e)){var i=t.v;Dt?ni.set(t,e):ni.set(t,i),t.v=e,(t.f&Xe)!==0&&((t.f&at)!==0&&or(t),tt(t,(t.f&Ye)===0?We:yt)),t.wv=Er(),ur(t,at),Se!==null&&(Se.f&We)!==0&&(Se.f&(st|bt))===0&&(Ze===null?Ln([t]):Ze.push(t))}return e}function ur(t,e){var i=t.reactions;if(i!==null)for(var r=i.length,n=0;n<r;n++){var s=i[n],l=s.f;(l&at)===0&&(tt(s,e),(l&(We|Ye))!==0&&((l&Xe)!==0?ur(s,yt):Ei(s)))}}let kn=!1;var cr,dr,fr,_r;function En(){if(cr===void 0){cr=window,dr=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,i=Text.prototype;fr=Ct(e,"firstChild").get,_r=Ct(e,"nextSibling").get,Xi(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Xi(i)&&(i.__t=void 0)}}function _i(t=""){return document.createTextNode(t)}function It(t){return fr.call(t)}function hi(t){return _r.call(t)}function a(t,e){return It(t)}function Ke(t,e){{var i=It(t);return i instanceof Comment&&i.data===""?hi(i):i}}function u(t,e=1,i=!1){let r=t;for(;e--;)r=hi(r);return r}function An(t){t.textContent=""}function Cn(t){Se===null&&we===null&&on(),we!==null&&(we.f&Ye)!==0&&Se===null&&an(),Dt&&sn()}function In(t,e){var i=e.last;i===null?e.last=e.first=t:(i.next=t,t.prev=i,e.last=t)}function Tt(t,e,i,r=!0){var n=Se,s={ctx:Ge,deps:null,nodes_start:null,nodes_end:null,f:t|at,first:null,fn:e,last:null,next:null,parent:n,prev:null,teardown:null,transitions:null,wv:0};if(i)try{Hi(s),s.f|=er}catch(d){throw it(s),d}else e!==null&&Ei(s);var l=i&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(tr|Ri))===0;if(!l&&r&&(n!==null&&In(s,n),we!==null&&(we.f&Xe)!==0)){var v=we;(v.effects??(v.effects=[])).push(s)}return s}function Tn(t){const e=Tt(Oi,null,!1);return tt(e,We),e.teardown=t,e}function wt(t){Cn();var e=Se!==null&&(Se.f&st)!==0&&Ge!==null&&!Ge.m;if(e){var i=Ge;(i.e??(i.e=[])).push({fn:t,effect:Se,reaction:we})}else{var r=hr(t);return r}}function Pn(t){const e=Tt(bt,t,!0);return()=>{it(e)}}function Dn(t){const e=Tt(bt,t,!0);return(i={})=>new Promise(r=>{i.outro?pi(e,()=>{it(e),r(void 0)}):(it(e),r(void 0))})}function hr(t){return Tt($i,t,!1)}function k(t,e=[],i=di){const r=e.map(i);return gi(()=>t(...r.map(o)))}function gi(t,e=0){return Tt(Oi|qi|e,t,!0)}function Pt(t,e=!0){return Tt(Oi|st,t,!0,e)}function gr(t){var e=t.teardown;if(e!==null){const i=Dt,r=we;Sr(!0),ft(null);try{e.call(null)}finally{Sr(i),ft(r)}}}function pr(t,e=!1){var i=t.first;for(t.first=t.last=null;i!==null;){var r=i.next;(i.f&bt)!==0?i.parent=null:it(i,e),i=r}}function On(t){for(var e=t.first;e!==null;){var i=e.next;(e.f&st)===0&&it(e),e=i}}function it(t,e=!0){var i=!1;(e||(t.f&en)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(qn(t.nodes_start,t.nodes_end),i=!0),pr(t,e&&!i),ki(t,0),tt(t,Mi);var r=t.transitions;if(r!==null)for(const s of r)s.stop();gr(t);var n=t.parent;n!==null&&n.first!==null&&mr(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function qn(t,e){for(;t!==null;){var i=t===e?null:hi(t);t.remove(),t=i}}function mr(t){var e=t.parent,i=t.prev,r=t.next;i!==null&&(i.next=r),r!==null&&(r.prev=i),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=i))}function pi(t,e){var i=[];Gi(t,i,!0),br(i,()=>{it(t),e&&e()})}function br(t,e){var i=t.length;if(i>0){var r=()=>--i||e();for(var n of t)n.out(r)}else e()}function Gi(t,e,i){if((t.f&ot)===0){if(t.f^=ot,t.transitions!==null)for(const l of t.transitions)(l.is_global||i)&&e.push(l);for(var r=t.first;r!==null;){var n=r.next,s=(r.f&ui)!==0||(r.f&st)!==0;Gi(r,e,s?i:!1),r=n}}}function mi(t){yr(t,!0)}function yr(t,e){if((t.f&ot)!==0){t.f^=ot,(t.f&We)!==0&&(tt(t,at),Ei(t));for(var i=t.first;i!==null;){var r=i.next,n=(i.f&ui)!==0||(i.f&st)!==0;yr(i,n?e:!1),i=r}if(t.transitions!==null)for(const s of t.transitions)(s.is_global||e)&&s.in()}}let bi=[];function Rn(){var t=bi;bi=[],$r(t)}function Mn(t){bi.length===0&&queueMicrotask(Rn),bi.push(t)}function Vn(t){var e=Se;if((e.f&er)===0){if((e.f&Ri)===0)throw t;e.fn(t)}else wr(t,e)}function wr(t,e){for(;e!==null;){if((e.f&Ri)!==0)try{e.fn(t);return}catch{}e=e.parent}throw t}let Bi=!1,yi=null,St=!1,Dt=!1;function Sr(t){Dt=t}let wi=[],rl=[],we=null,rt=!1;function ft(t){we=t}let Se=null;function Ot(t){Se=t}let lt=null;function xr(t){we!==null&&we.f&Vi&&(lt===null?lt=[t]:lt.push(t))}let Be=null,Je=0,Ze=null;function Ln(t){Ze=t}let kr=1,Si=0,_t=!1;function Er(){return++kr}function xi(t){var e=t.f;if((e&at)!==0)return!0;if((e&yt)!==0){var i=t.deps,r=(e&Ye)!==0;if(i!==null){var n,s,l=(e&vi)!==0,v=r&&Se!==null&&!_t,d=i.length;if(l||v){var _=t,S=_.parent;for(n=0;n<d;n++)s=i[n],(l||!s?.reactions?.includes(_))&&(s.reactions??(s.reactions=[])).push(_);l&&(_.f^=vi),v&&S!==null&&(S.f&Ye)===0&&(_.f^=Ye)}for(n=0;n<d;n++)if(s=i[n],xi(s)&&lr(s),s.wv>t.wv)return!0}(!r||Se!==null&&!_t)&&tt(t,We)}return!1}function Ar(t,e,i=!0){var r=t.reactions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];lt?.includes(t)||((s.f&Xe)!==0?Ar(s,e,!1):e===s&&(i?tt(s,at):(s.f&We)!==0&&tt(s,yt),Ei(s)))}}function Cr(t){var g;var e=Be,i=Je,r=Ze,n=we,s=_t,l=lt,v=Ge,d=rt,_=t.f;Be=null,Je=0,Ze=null,_t=(_&Ye)!==0&&(rt||!St||we===null),we=(_&(st|bt))===0?t:null,lt=null,nr(t.ctx),rt=!1,Si++,t.f|=Vi;try{var S=(0,t.fn)(),b=t.deps;if(Be!==null){var c;if(ki(t,Je),b!==null&&Je>0)for(b.length=Je+Be.length,c=0;c<Be.length;c++)b[Je+c]=Be[c];else t.deps=b=Be;if(!_t)for(c=Je;c<b.length;c++)((g=b[c]).reactions??(g.reactions=[])).push(t)}else b!==null&&Je<b.length&&(ki(t,Je),b.length=Je);if(sr()&&Ze!==null&&!rt&&b!==null&&(t.f&(Xe|yt|at))===0)for(c=0;c<Ze.length;c++)Ar(Ze[c],t);return n!==null&&n!==t&&(Si++,Ze!==null&&(r===null?r=Ze:r.push(...Ze))),S}catch(w){Vn(w)}finally{Be=e,Je=i,Ze=r,we=n,_t=s,lt=l,nr(v),rt=d,t.f^=Vi}}function Nn(t,e){let i=e.reactions;if(i!==null){var r=li.call(i,t);if(r!==-1){var n=i.length-1;n===0?i=e.reactions=null:(i[r]=i[n],i.pop())}}i===null&&(e.f&Xe)!==0&&(Be===null||!Be.includes(e))&&(tt(e,yt),(e.f&(Ye|vi))===0&&(e.f^=vi),ar(e),ki(e,0))}function ki(t,e){var i=t.deps;if(i!==null)for(var r=e;r<i.length;r++)Nn(t,i[r])}function Hi(t){var e=t.f;if((e&Mi)===0){tt(t,We);var i=Se,r=St;Se=t,St=!0;try{(e&qi)!==0?On(t):pr(t),gr(t);var n=Cr(t);t.teardown=typeof n=="function"?n:null,t.wv=kr;var s}finally{St=r,Se=i}}}function zn(){try{ln()}catch(t){if(yi!==null)wr(t,yi);else throw t}}function Fn(){var t=St;try{var e=0;for(St=!0;wi.length>0;){e++>1e3&&zn();var i=wi,r=i.length;wi=[];for(var n=0;n<r;n++){var s=jn(i[n]);Un(s)}ni.clear()}}finally{Bi=!1,St=t,yi=null}}function Un(t){var e=t.length;if(e!==0)for(var i=0;i<e;i++){var r=t[i];(r.f&(Mi|ot))===0&&xi(r)&&(Hi(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?mr(r):r.fn=null))}}function Ei(t){Bi||(Bi=!0,queueMicrotask(Fn));for(var e=yi=t;e.parent!==null;){e=e.parent;var i=e.f;if((i&(bt|st))!==0){if((i&We)===0)return;e.f^=We}}wi.push(e)}function jn(t){for(var e=[],i=t;i!==null;){var r=i.f,n=(r&(st|bt))!==0,s=n&&(r&We)!==0;if(!s&&(r&ot)===0){(r&$i)!==0?e.push(i):n?i.f^=We:xi(i)&&Hi(i);var l=i.first;if(l!==null){i=l;continue}}var v=i.parent;for(i=i.next;i===null&&v!==null;)i=v.next,v=v.parent}return e}function o(t){var e=t.f,i=(e&Xe)!==0;if(we!==null&&!rt){if(!lt?.includes(t)){var r=we.deps;t.rv<Si&&(t.rv=Si,Be===null&&r!==null&&r[Je]===t?Je++:Be===null?Be=[t]:(!_t||!Be.includes(t))&&Be.push(t))}}else if(i&&t.deps===null&&t.effects===null){var n=t,s=n.parent;s!==null&&(s.f&Ye)===0&&(n.f^=Ye)}return i&&(n=t,xi(n)&&lr(n)),Dt&&ni.has(t)?ni.get(t):t.v}function Ai(t){var e=rt;try{return rt=!0,t()}finally{rt=e}}const Gn=-7169;function tt(t,e){t.f=t.f&Gn|e}const Bn=["touchstart","touchmove"];function Hn(t){return Bn.includes(t)}const Ir=new Set,Qi=new Set;function ht(t){for(var e=0;e<t.length;e++)Ir.add(t[e]);for(var i of Qi)i(t)}function Ci(t){var e=this,i=e.ownerDocument,r=t.type,n=t.composedPath?.()||[],s=n[0]||t.target,l=0,v=t.__root;if(v){var d=n.indexOf(v);if(d!==-1&&(e===document||e===window)){t.__root=e;return}var _=n.indexOf(e);if(_===-1)return;d<=_&&(l=d)}if(s=n[l]||t.target,s!==e){Wr(t,"currentTarget",{configurable:!0,get(){return s||i}});var S=we,b=Se;ft(null),Ot(null);try{for(var c,g=[];s!==null;){var w=s.assignedSlot||s.parentNode||s.host||null;try{var O=s["__"+r];if(O!=null&&(!s.disabled||t.target===s))if(je(O)){var[M,...A]=O;M.apply(s,[t,...A])}else O.call(s,t)}catch(x){c?g.push(x):c=x}if(t.cancelBubble||w===e||w===null)break;s=w}if(c){for(let x of g)queueMicrotask(()=>{throw x});throw c}}finally{t.__root=e,delete t.currentTarget,ft(S),Ot(b)}}}function Tr(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function si(t,e){var i=Se;i.nodes_start===null&&(i.nodes_start=t,i.nodes_end=e)}function h(t,e){var i=(e&bn)!==0,r=(e&yn)!==0,n,s=!t.startsWith("<!>");return()=>{n===void 0&&(n=Tr(s?t:"<!>"+t),i||(n=It(n)));var l=r||dr?document.importNode(n,!0):n.cloneNode(!0);if(i){var v=It(l),d=l.lastChild;si(v,d)}else si(l,l);return l}}function Qn(t,e,i="svg"){var r=!t.startsWith("<!>"),n=`<${i}>${r?t:"<!>"+t}</${i}>`,s;return()=>{if(!s){var l=Tr(n),v=It(l);s=It(v)}var d=s.cloneNode(!0);return si(d,d),d}}function Yn(t,e){return Qn(t,e,"svg")}function xt(t=""){{var e=_i(t+"");return si(e,e),e}}function vt(){var t=document.createDocumentFragment(),e=document.createComment(""),i=_i();return t.append(e,i),si(e,i),t}function f(t,e){t!==null&&t.before(e)}function y(t,e){var i=e==null?"":typeof e=="object"?e+"":e;i!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=i,t.nodeValue=i+"")}function Wn(t,e){return Kn(t,e)}const qt=new Map;function Kn(t,{target:e,anchor:i,props:r={},events:n,context:s,intro:l=!0}){En();var v=new Set,d=b=>{for(var c=0;c<b.length;c++){var g=b[c];if(!v.has(g)){v.add(g);var w=Hn(g);e.addEventListener(g,Ci,{passive:w});var O=qt.get(g);O===void 0?(document.addEventListener(g,Ci,{passive:w}),qt.set(g,1)):qt.set(g,O+1)}}};d(Pi(Ir)),Qi.add(d);var _=void 0,S=Dn(()=>{var b=i??e.appendChild(_i());return Pt(()=>{if(s){$e({});var c=Ge;c.c=s}n&&(r.$$events=n),_=t(b,r)||{},s&&et()}),()=>{for(var c of v){e.removeEventListener(c,Ci);var g=qt.get(c);--g===0?(document.removeEventListener(c,Ci),qt.delete(c)):qt.set(c,g)}Qi.delete(d),b!==i&&b.parentNode?.removeChild(b)}});return Jn.set(_,S),_}let Jn=new WeakMap;function m(t,e,[i,r]=[0,0]){var n=t,s=null,l=null,v=He,d=i>0?ui:0,_=!1;const S=(c,g=!0)=>{_=!0,b(g,c)},b=(c,g)=>{v!==(v=c)&&(v?(s?mi(s):g&&(s=Pt(()=>g(n))),l&&pi(l,()=>{l=null})):(l?mi(l):g&&(l=Pt(()=>g(n,[i+1,r]))),s&&pi(s,()=>{s=null})))};gi(()=>{_=!1,e(S),_||b(null,null)},d)}function Qe(t,e){return e}function Zn(t,e,i,r){for(var n=[],s=e.length,l=0;l<s;l++)Gi(e[l].e,n,!0);var v=s>0&&n.length===0&&i!==null;if(v){var d=i.parentNode;An(d),d.append(i),r.clear(),gt(t,e[0].prev,e[s-1].next)}br(n,()=>{for(var _=0;_<s;_++){var S=e[_];v||(r.delete(S.k),gt(t,S.prev,S.next)),it(S.e,!v)}})}function Ue(t,e,i,r,n,s=null){var l=t,v={flags:e,items:new Map,first:null},d=(e&rr)!==0;if(d){var _=t;l=_.appendChild(_i())}var S=null,b=!1,c=Sn(()=>{var g=i();return je(g)?g:g==null?[]:Pi(g)});gi(()=>{var g=o(c),w=g.length;b&&w===0||(b=w===0,Xn(g,v,l,n,e,r,i),s!==null&&(w===0?S?mi(S):S=Pt(()=>s(l)):S!==null&&pi(S,()=>{S=null})),o(c))})}function Xn(t,e,i,r,n,s,l){var v=(n&fn)!==0,d=(n&(Ni|zi))!==0,_=t.length,S=e.items,b=e.first,c=b,g,w=null,O,M=[],A=[],x,T,I,C;if(v)for(C=0;C<_;C+=1)x=t[C],T=s(x,C),I=S.get(T),I!==void 0&&(I.a?.measure(),(O??(O=new Set)).add(I));for(C=0;C<_;C+=1){if(x=t[C],T=s(x,C),I=S.get(T),I===void 0){var se=c?c.e.nodes_start:i;w=es(se,e,w,w===null?e.first:w.next,x,T,C,r,n,l),S.set(T,w),M=[],A=[],c=w.next;continue}if(d&&$n(I,x,C,n),(I.e.f&ot)!==0&&(mi(I.e),v&&(I.a?.unfix(),(O??(O=new Set)).delete(I))),I!==c){if(g!==void 0&&g.has(I)){if(M.length<A.length){var re=A[0],ne;w=re.prev;var Pe=M[0],Ae=M[M.length-1];for(ne=0;ne<M.length;ne+=1)Pr(M[ne],re,i);for(ne=0;ne<A.length;ne+=1)g.delete(A[ne]);gt(e,Pe.prev,Ae.next),gt(e,w,Pe),gt(e,Ae,re),c=re,w=Ae,C-=1,M=[],A=[]}else g.delete(I),Pr(I,c,i),gt(e,I.prev,I.next),gt(e,I,w===null?e.first:w.next),gt(e,w,I),w=I;continue}for(M=[],A=[];c!==null&&c.k!==T;)(c.e.f&ot)===0&&(g??(g=new Set)).add(c),A.push(c),c=c.next;if(c===null)continue;I=c}M.push(I),w=I,c=I.next}if(c!==null||g!==void 0){for(var V=g===void 0?[]:Pi(g);c!==null;)(c.e.f&ot)===0&&V.push(c),c=c.next;var j=V.length;if(j>0){var _e=(n&rr)!==0&&_===0?i:null;if(v){for(C=0;C<j;C+=1)V[C].a?.measure();for(C=0;C<j;C+=1)V[C].a?.fix()}Zn(e,V,_e,S)}}v&&Mn(()=>{if(O!==void 0)for(I of O)I.a?.apply()}),Se.first=e.first&&e.first.e,Se.last=w&&w.e}function $n(t,e,i,r){(r&Ni)!==0&&ji(t.v,e),(r&zi)!==0?ji(t.i,i):t.i=i}function es(t,e,i,r,n,s,l,v,d,_){var S=(d&Ni)!==0,b=(d&_n)===0,c=S?b?vr(n,!1,!1):fi(n):n,g=(d&zi)===0?l:fi(l),w={i:g,v:c,k:s,a:null,e:null,prev:i,next:r};try{return w.e=Pt(()=>v(t,c,g,_),kn),w.e.prev=i&&i.e,w.e.next=r&&r.e,i===null?e.first=w:(i.next=w,i.e.next=w.e),r!==null&&(r.prev=w,r.e.prev=w.e),w}finally{}}function Pr(t,e,i){for(var r=t.next?t.next.e.nodes_start:i,n=e?e.e.nodes_start:i,s=t.e.nodes_start;s!==r;){var l=hi(s);n.before(s),s=l}}function gt(t,e,i){e===null?t.first=i:(e.next=i,e.e.next=i&&i.e),i!==null&&(i.prev=e,i.e.prev=e&&e.e)}function Dr(t,e,...i){var r=t,n=Xr,s;gi(()=>{n!==(n=e())&&(s&&(it(s),s=null),s=Pt(()=>n(r,...i)))},ui)}function Or(t){var e,i,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(i=Or(t[e]))&&(r&&(r+=" "),r+=i)}else for(i in t)t[i]&&(r&&(r+=" "),r+=i);return r}function ts(){for(var t,e,i=0,r="",n=arguments.length;i<n;i++)(t=arguments[i])&&(e=Or(t))&&(r&&(r+=" "),r+=e);return r}function kt(t){return typeof t=="object"?ts(t):t??""}const qr=[...` 	
\r\f \v\uFEFF`];function is(t,e,i){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),i){for(var n in i)if(i[n])r=r?r+" "+n:n;else if(r.length)for(var s=n.length,l=0;(l=r.indexOf(n,l))>=0;){var v=l+s;(l===0||qr.includes(r[l-1]))&&(v===r.length||qr.includes(r[v]))?r=(l===0?"":r.substring(0,l))+r.substring(v+1):l=v}}return r===""?null:r}function rs(t,e){return t==null?null:String(t)}function xe(t,e,i,r,n,s){var l=t.__className;if(l!==i||l===void 0){var v=is(i,r,s);v==null?t.removeAttribute("class"):e?t.className=v:t.setAttribute("class",v),t.__className=i}else if(s&&n!==s)for(var d in s){var _=!!s[d];(n==null||_!==!!n[d])&&t.classList.toggle(d,_)}return s}function ns(t,e,i,r){var n=t.__style;if(n!==e){var s=rs(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return r}const ss=Symbol("is custom element"),as=Symbol("is html");function os(t,e){var i=Yi(t);i.value===(i.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Rr(t,e){var i=Yi(t);i.checked!==(i.checked=e??void 0)&&(t.checked=e)}function pt(t,e,i,r){var n=Yi(t);n[e]!==(n[e]=i)&&(e==="loading"&&(t[rn]=i),i==null?t.removeAttribute(e):typeof i!="string"&&ls(t).includes(e)?t[e]=i:t.setAttribute(e,i))}function Yi(t){return t.__attributes??(t.__attributes={[ss]:t.nodeName.includes("-"),[as]:t.namespaceURI===wn})}var Mr=new Map;function ls(t){var e=Mr.get(t.nodeName);if(e)return e;Mr.set(t.nodeName,e=[]);for(var i,r=t,n=Element.prototype;n!==r;){i=Kr(r);for(var s in i)i[s].set&&e.push(s);r=Zi(r)}return e}let Ii=!1;function vs(t){var e=Ii;try{return Ii=!1,[t(),Ii]}finally{Ii=e}}function Vr(t){return t.ctx?.d??!1}function Z(t,e,i,r){var n=(i&hn)!==0,s=!0,l=(i&pn)!==0,v=(i&mn)!==0,d=!1,_;l?[_,d]=vs(()=>t[e]):_=t[e];var S=ci in t||tn in t,b=l&&(Ct(t,e)?.set??(S&&e in t&&(C=>t[e]=C)))||void 0,c=r,g=!0,w=!1,O=()=>(w=!0,g&&(g=!1,v?c=Ai(r):c=r),c);_===void 0&&r!==void 0&&(b&&s&&vn(),_=O(),b&&b(_));var M;if(M=()=>{var C=t[e];return C===void 0?O():(g=!0,w=!1,C)},(i&gn)===0&&s)return M;if(b){var A=t.$$legacy;return function(C,se){return arguments.length>0?((!se||A||d)&&b(se?M():C),C):M()}}var x=!1,T=vr(_),I=di(()=>{var C=M(),se=o(T);return x?(x=!1,se):T.v=C});return l&&o(I),n||(I.equals=Li),function(C,se){if(arguments.length>0){const re=se?o(I):l?Me(C):C;if(!I.equals(re)){if(x=!0,z(T,re),w&&c!==void 0&&(c=re),Vr(I))return C;Ai(()=>o(I))}return C}return Vr(I)?I.v:o(I)}}function Ti(t){Ge===null&&Fi(),wt(()=>{const e=Ai(t);if(typeof e=="function")return e})}function us(t){Ge===null&&Fi(),Ti(()=>()=>Ai(t))}function cs(t,e,{bubbles:i=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:i,cancelable:r})}function ds(){const t=Ge;return t===null&&Fi(),(e,i,r)=>{const n=t.s.$$events?.[e];if(n){const s=je(n)?n.slice():[n],l=cs(e,i,r);for(const v of s)v.call(t.x,l);return!l.defaultPrevented}return!0}}const fs="5";typeof window<"u"&&((Fr=window.__svelte??(window.__svelte={})).v??(Fr.v=new Set)).add(fs);class _s{constructor(e,i={}){this.baseUrl=e||window.__API_BASE_URL__||"http://localhost:8080/api/v1",this.modelId=i.modelId,this.authToken=i.authToken||localStorage.getItem("auth_token"),this.timeout=i.timeout||3e4,console.log("API Client initialized:",{baseUrl:this.baseUrl,modelId:this.modelId,hasAuth:!!this.authToken})}async request(e,i={}){const r=`${this.baseUrl}${e}`;console.log(`API Request: ${i.method||"GET"} ${r}`);const n={method:"GET",headers:{"Content-Type":"application/json",...this.authToken&&{Authorization:`Bearer ${this.authToken}`},...i.headers},...i};n.body&&typeof n.body=="object"&&(n.body=JSON.stringify(n.body));try{const s=new AbortController,l=setTimeout(()=>s.abort(),this.timeout),v=await fetch(r,{...n,signal:s.signal});if(clearTimeout(l),!v.ok){const _=await v.json().catch(()=>({message:v.statusText}));throw new Error(_.message||_.error||`HTTP ${v.status}`)}const d=await v.json();return(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.log(`API Response from ${e}:`,d),d&&typeof d=="object"&&d.success!==void 0&&d.data!==void 0?d.data:d??(e.includes("/groups")||e.includes("/options")||e.includes("/rules")?[]:{})}catch(s){throw s.name==="AbortError"?new Error("Request timeout"):(console.error(`API Error for ${e}:`,s),s)}}async getModel(){if(!this.modelId)throw new Error("Model ID required");const e=await this.request(`/models/${this.modelId}`);return!e.option_groups&&e.groups&&(e.option_groups=e.groups),console.log("Model structure:",{hasGroups:!!e.groups,hasOptionGroups:!!e.option_groups,hasOptions:!!e.options,groupsCount:e.groups?.length||e.option_groups?.length||0,optionsCount:e.options?.length||0}),e}async getModelGroups(){if(!this.modelId)throw new Error("Model ID required");const e=await this.request(`/models/${this.modelId}/groups`);return Array.isArray(e)?e:[]}async getModelOptions(){if(!this.modelId)throw new Error("Model ID required");const e=await this.request(`/models/${this.modelId}/options`);return Array.isArray(e)?e:[]}async getModelRules(){if(!this.modelId)throw new Error("Model ID required");const e=await this.request(`/models/${this.modelId}/rules`);return Array.isArray(e)?e:[]}async getModelPricingRules(){if(!this.modelId)throw new Error("Model ID required");const e=await this.request(`/models/${this.modelId}/pricing-rules`);return Array.isArray(e)?e:[]}async getModelStatistics(){if(!this.modelId)throw new Error("Model ID required");return this.request(`/models/${this.modelId}/statistics`)}async createConfiguration(e=[]){return this.request("/configurations",{method:"POST",body:{model_id:"sample-laptop",name:`Configuration ${new Date().toISOString()}`,selections:this.formatSelections(e)}})}async getConfiguration(e){return this.request(`/configurations/${e}`)}async updateConfiguration(e,i){return this.request(`/configurations/${e}`,{method:"PUT",body:{model_id:this.modelId,...i,selections:i.selections?this.formatSelections(i.selections):void 0}})}async deleteConfiguration(e){return this.request(`/configurations/${e}`,{method:"DELETE"})}async addSelections(e,i){return this.request(`/configurations/${e}/selections`,{method:"POST",body:{selections:this.formatSelections(i)}})}async removeSelection(e,i){return this.request(`/configurations/${e}/selections/${i}`,{method:"DELETE"})}async validateConfiguration(e){return this.request(`/configurations/${e}/validate`,{method:"POST"})}async validateSelections(e){return this.request("/configurations/validate-selection",{method:"POST",body:{model_id:this.modelId,selections:this.formatSelections(e)}})}async getAvailableOptions(e){return this.request(`/configurations/${e}/available-options`)}async getConstraints(e){return this.request(`/configurations/${e}/constraints`)}async getConfigurationSummary(e){return this.request(`/configurations/${e}/summary`)}async cloneConfiguration(e){return this.request(`/configurations/${e}/clone`,{method:"POST"})}async calculatePrice(e,i={}){return this.request("/pricing/calculate",{method:"POST",body:{model_id:this.modelId,selections:this.formatSelections(e),context:i}})}async simulatePricing(e){return this.request("/pricing/simulate",{method:"POST",body:{model_id:this.modelId,scenarios:e}})}async validatePricing(e,i){return this.request("/pricing/validate",{method:"POST",body:{model_id:this.modelId,selections:this.formatSelections(e),expected_price:i}})}async getPricingRules(){if(!this.modelId)throw new Error("Model ID required");return this.request(`/pricing/rules/${this.modelId}`)}async getVolumeTiers(){if(!this.modelId)throw new Error("Model ID required");return this.request(`/pricing/volume-tiers/${this.modelId}`)}async validateModel(){if(!this.modelId)throw new Error("Model ID required");return this.request(`/models/${this.modelId}/validate`,{method:"POST"})}async detectConflicts(e=[]){if(!this.modelId)throw new Error("Model ID required");return this.request(`/models/${this.modelId}/conflicts`,{method:"POST",body:{rule_ids:e}})}async analyzeImpact(e){if(!this.modelId)throw new Error("Model ID required");return this.request(`/models/${this.modelId}/impact`,{method:"POST",body:e})}async getModelQuality(){if(!this.modelId)throw new Error("Model ID required");return this.request(`/models/${this.modelId}/quality`,{method:"POST"})}async getOptimizationRecommendations(){if(!this.modelId)throw new Error("Model ID required");return this.request(`/models/${this.modelId}/optimize`,{method:"POST"})}formatSelections(e){return Array.isArray(e)?e:Object.entries(e).filter(([i,r])=>r>0).map(([i,r])=>({option_id:i,quantity:parseInt(r)||1}))}async batchValidate(e){return this.request("/configurations/validate",{method:"POST",body:{configurations:e}})}async bulkCalculatePricing(e){return this.request("/pricing/bulk-calculate",{method:"POST",body:{configurations:e}})}async checkHealth(){return this.request("/health")}async getStatus(){return this.request("/status")}}function Lr(t){return typeof t!="string"?!1:["=>","function","$props","$","$.strict_equals","return ","${","() =>","} else","if (",".selection_type","strict_equals","min_selections","max_selections"].some(i=>t.includes(i))}function Nr(t,e=""){if(t==null)return e;const i=String(t);return typeof t=="string"&&!Lr(i)?i:Lr(i)?(console.warn("[Sanitizer] Code pattern detected and removed:",{original:i.substring(0,100)+(i.length>100?"...":""),fallback:e}),e):i}class hs{constructor(){Ce(this,Rt);Ce(this,Mt);Ce(this,Vt);Ce(this,Lt);Ce(this,Nt);Ce(this,zt);Ce(this,Ft);Ce(this,Ut);Ce(this,jt);Ce(this,Gt);Ce(this,Bt);Ce(this,Ht);Ce(this,Qt);Ce(this,Yt);Ce(this,Wt);Ce(this,Kt);Ce(this,Jt);Ce(this,Zt);Ce(this,Xt);Ce(this,$t);Ce(this,ei);Ce(this,ti);Ce(this,ii);Ce(this,ri);Ie(this,Rt,H("")),Ie(this,Mt,H(null)),Ie(this,Vt,H(null)),Ie(this,Lt,H(Me({}))),Ie(this,Nt,H(null)),Ie(this,zt,H(null)),Ie(this,Ft,H(Me([]))),Ie(this,Ut,H(Me([]))),Ie(this,jt,H(Me([]))),Ie(this,Gt,H(Me([]))),Ie(this,Bt,H(Me([]))),Ie(this,Ht,H(Me([]))),Ie(this,Qt,H(Me([]))),Ie(this,Yt,H(!1)),Ie(this,Wt,H(!1)),Ie(this,Kt,H(!1)),Ie(this,Jt,H(!1)),Ie(this,Zt,H(null)),Ie(this,Xt,H(Me([]))),Ie(this,$t,H(null)),Ie(this,ei,H(null)),Ie(this,ti,H(!1)),Ie(this,ii,H(0)),Ie(this,ri,H(Me(new Set))),this.api=null,this._initialized=!1,this._debounceTimers=new Map,this._modelLoaded=!1}get modelId(){return o(N(this,Rt))}set modelId(e){z(N(this,Rt),e,!0)}get model(){return o(N(this,Mt))}set model(e){z(N(this,Mt),e,!0)}get configuration(){return o(N(this,Vt))}set configuration(e){z(N(this,Vt),e,!0)}get selections(){return o(N(this,Lt))}set selections(e){z(N(this,Lt),e,!0)}get validationResults(){return o(N(this,Nt))}set validationResults(e){z(N(this,Nt),e,!0)}get pricingData(){return o(N(this,zt))}set pricingData(e){z(N(this,zt),e,!0)}get availableOptions(){return o(N(this,Ft))}set availableOptions(e){z(N(this,Ft),e,!0)}get constraints(){return o(N(this,Ut))}set constraints(e){z(N(this,Ut),e,!0)}get groups(){return o(N(this,jt))}set groups(e){z(N(this,jt),e,!0)}get options(){return o(N(this,Gt))}set options(e){z(N(this,Gt),e,!0)}get rules(){return o(N(this,Bt))}set rules(e){z(N(this,Bt),e,!0)}get pricingRules(){return o(N(this,Ht))}set pricingRules(e){z(N(this,Ht),e,!0)}get volumeTiers(){return o(N(this,Qt))}set volumeTiers(e){z(N(this,Qt),e,!0)}get isLoading(){return o(N(this,Yt))}set isLoading(e){z(N(this,Yt),e,!0)}get isValidating(){return o(N(this,Wt))}set isValidating(e){z(N(this,Wt),e,!0)}get isPricing(){return o(N(this,Kt))}set isPricing(e){z(N(this,Kt),e,!0)}get isSaving(){return o(N(this,Jt))}set isSaving(e){z(N(this,Jt),e,!0)}get error(){return o(N(this,Zt))}set error(e){z(N(this,Zt),e,!0)}get validationErrors(){return o(N(this,Xt))}set validationErrors(e){z(N(this,Xt),e,!0)}get configurationId(){return o(N(this,$t))}set configurationId(e){z(N(this,$t),e,!0)}get lastSaved(){return o(N(this,ei))}set lastSaved(e){z(N(this,ei),e,!0)}get isDirty(){return o(N(this,ti))}set isDirty(e){z(N(this,ti),e,!0)}get currentStep(){return o(N(this,ii))}set currentStep(e){z(N(this,ii),e,!0)}get expandedGroups(){return o(N(this,ri))}set expandedGroups(e){z(N(this,ri),e,!0)}async initialize(){this._initialized||(this._initialized=!0,console.log("🚀 ConfigurationStore initialized"),Array.isArray(this.groups)||(this.groups=[]),Array.isArray(this.options)||(this.options=[]),Array.isArray(this.rules)||(this.rules=[]),Array.isArray(this.pricingRules)||(this.pricingRules=[]),Array.isArray(this.volumeTiers)||(this.volumeTiers=[]),Array.isArray(this.availableOptions)||(this.availableOptions=[]),Array.isArray(this.validationErrors)||(this.validationErrors=[]),wt(()=>{this.modelId&&!this.api&&(this.api=new _s(window.__API_BASE_URL__,{modelId:this.modelId}),this.loadModel())}),wt(()=>{this.api&&Object.keys(this.selections).length>0&&this._debounce("validate",()=>this.validateSelections(),500)}),wt(()=>{this.api&&this.isValid&&Object.keys(this.selections).length>0&&this._debounce("pricing",()=>this.calculatePricing(),300)}),wt(()=>{this.configuration&&Object.keys(this.selections).length>0&&(this.isDirty=!0)}))}get isValid(){return!this.validationResults||this.validationResults.is_valid}get hasViolations(){return this.validationResults?.violations?.length>0}get totalPrice(){return this.pricingData?.total_price||0}get basePrice(){return this.pricingData?.base_price||0}get discounts(){return this.pricingData?.discounts||[]}get selectedCount(){return Object.values(this.selections).reduce((e,i)=>e+i,0)}get safeGroups(){return Array.isArray(this.groups)?this.groups:[]}get safeOptions(){return Array.isArray(this.options)?this.options:[]}get safeRules(){return Array.isArray(this.rules)?this.rules:[]}get safePricingRules(){return Array.isArray(this.pricingRules)?this.pricingRules:[]}get safeVolumeTiers(){return Array.isArray(this.volumeTiers)?this.volumeTiers:[]}get progress(){if(!this.model||!this._modelLoaded)return 0;const e=this.safeGroups;if(e.length===0)return 0;const i=e.filter(n=>n&&n.required).length;if(i===0)return 100;const r=e.filter(n=>n&&n.id&&this.hasGroupSelection(n.id)).length;return Math.round(r/i*100)}async loadModel(){if(this.api){this.isLoading=!0,this.error=null;try{const[e,i,r,n,s]=await Promise.all([this.api.getModel(),this.api.getModelGroups(),this.api.getModelOptions(),this.api.getModelRules().catch(()=>({data:[]})),this.api.getModelPricingRules().catch(()=>({data:[]}))]);if(this.model=e,this.groups=Array.isArray(i)?i:i&&typeof i=="object"&&i.data?i.data:i&&typeof i=="object"&&i.groups?i.groups:e&&e.option_groups&&Array.isArray(e.option_groups)?e.option_groups:e&&e.groups&&Array.isArray(e.groups)?e.groups:[],this.options=Array.isArray(r)?r:r&&typeof r=="object"&&r.data?r.data:r&&typeof r=="object"&&r.options?r.options:e&&e.options&&Array.isArray(e.options)?e.options:[],this.rules=Array.isArray(n)?n:n&&typeof n=="object"&&n.data?n.data:n&&typeof n=="object"&&n.rules?n.rules:[],this.pricingRules=Array.isArray(s)?s:s&&typeof s=="object"&&s.data?s.data:s&&typeof s=="object"&&s.pricing_rules?s.pricing_rules:[],this.groups=this.groups.map(l=>({...l,description:typeof l.description=="string"&&(l.description.includes("=>")||l.description.includes("function")||l.description.includes("$props"))?"":l.description})),this.options=this.options.map(l=>({...l,description:typeof l.description=="string"&&(l.description.includes("=>")||l.description.includes("function")||l.description.includes("$props"))?"":l.description})),Array.isArray(this.groups)||(this.groups=[]),Array.isArray(this.options)||(this.options=[]),Array.isArray(this.rules)||(this.rules=[]),Array.isArray(this.pricingRules)||(this.pricingRules=[]),this.groups.length===0&&e.option_groups&&(console.log("Using groups from model.option_groups"),this.groups=Array.isArray(e.option_groups)?e.option_groups:[]),this.groups.length===0&&e.groups&&(console.log("Using groups from model.groups"),this.groups=Array.isArray(e.groups)?e.groups:[]),this.options.length===0&&e.options&&(console.log("Using options from model.options"),this.options=Array.isArray(e.options)?e.options:[]),this.options.length===0&&this.groups.length>0){const l=[];this.groups.forEach(v=>{Array.isArray(v.options)&&v.options.forEach(d=>{l.push({...d,group_id:v.id})})}),l.length>0&&(console.log("Extracted options from groups:",l.length),this.options=l)}console.log("Model loaded:",{model:e,groups:this.groups,options:this.options,groupsCount:this.groups.length,optionsCount:this.options.length}),this.groups.forEach((l,v)=>{l.description&&typeof l.description=="string"&&(l.description.includes("=>")||l.description.includes("function"))&&console.warn(`Group ${v} (${l.name}) has function code in description:`,l.description),l.name&&typeof l.name=="string"&&(l.name.includes("=>")||l.name.includes("function"))&&console.warn(`Group ${v} has function code in name:`,l.name)}),this.options.forEach((l,v)=>{l.description&&typeof l.description=="string"&&(l.description.includes("=>")||l.description.includes("function"))&&console.warn(`Option ${v} (${l.name}) has function code in description:`,l.description),l.name&&typeof l.name=="string"&&(l.name.includes("=>")||l.name.includes("function"))&&console.warn(`Option ${v} has function code in name:`,l.name)});try{const l=await this.api.getVolumeTiers();this.volumeTiers=Array.isArray(l)?l:l&&typeof l=="object"&&l.data?l.data:l&&typeof l=="object"&&l.tiers?l.tiers:[]}catch{console.warn("Volume tiers not available"),this.volumeTiers=[]}Array.isArray(this.volumeTiers)||(this.volumeTiers=[]),this.groups.length>0||this.options.length>0?(this._modelLoaded=!0,await this.createConfiguration()):console.warn("No groups or options loaded - skipping configuration creation")}catch(e){this.error=e.message,console.error("Failed to load model:",e)}finally{this.isLoading=!1}}}async createConfiguration(){if(!(!this.api||this.configuration))try{const e=await this.api.createConfiguration([]);this.configuration=e,this.configurationId=e.id,console.log("Configuration created:",e.id)}catch(e){this.error=e.message,console.error("Failed to create configuration:",e)}}async loadConfiguration(e){if(this.api){this.isLoading=!0;try{const i=await this.api.getConfiguration(e);this.configuration=i,this.configurationId=i.id;const r={};i.selections?.forEach(n=>{r[n.option_id]=n.quantity}),this.selections=r,await Promise.all([this.validateConfiguration(),this.calculatePricing()])}catch(i){this.error=i.message}finally{this.isLoading=!1}}}async saveConfiguration(){if(!(!this.api||!this.configurationId||!this.isDirty)){this.isSaving=!0;try{await this.api.updateConfiguration(this.configurationId,{selections:this.selections,name:`Configuration ${new Date().toLocaleDateString()}`}),this.lastSaved=new Date,this.isDirty=!1}catch(e){console.error("Failed to save configuration:",e)}finally{this.isSaving=!1}}}async updateSelection(e,i){const r=this.safeOptions,n=this.safeGroups;if(r.length===0){console.warn("Cannot update selection - options not loaded");return}const s={...this.selections};i>0?s[e]=i:delete s[e];const l=r.find(v=>v.id===e);if(l){const v=n.find(d=>d.id===l.group_id);if(v?.selection_type==="single"&&r.filter(d=>d.group_id===v.id&&d.id!==e).forEach(d=>delete s[d.id]),v?.max_selections&&r.filter(_=>_.group_id===v.id&&s[_.id]).length>v.max_selections){this.error=`Maximum ${v.max_selections} selections allowed in ${v.name}`;return}}if(this.selections=s,this.configurationId)try{i>0?await this.api.addSelections(this.configurationId,s):await this.api.removeSelection(this.configurationId,e)}catch(v){this.error=v.message}}toggleOption(e){const i=this.selections[e]||0;return this.updateSelection(e,i>0?0:1)}async validateSelections(){if(!(!this.api||this.isValidating)){this.isValidating=!0,this.validationErrors=[];try{const e=await this.api.validateSelections(this.selections);this.validationResults=e,e.available_options&&(this.availableOptions=e.available_options),e.violations&&(this.validationErrors=e.violations)}catch(e){console.error("Validation failed:",e)}finally{this.isValidating=!1}}}async validateConfiguration(){if(!(!this.api||!this.configurationId)){this.isValidating=!0;try{const e=await this.api.validateConfiguration(this.configurationId);this.validationResults=e,e.available_options&&(this.availableOptions=e.available_options)}catch(e){console.error("Configuration validation failed:",e)}finally{this.isValidating=!1}}}async calculatePricing(e={}){if(!(!this.api||this.isPricing)){this.isPricing=!0;try{const i=await this.api.calculatePrice(this.selections,e);this.pricingData=i}catch(i){console.error("Pricing calculation failed:",i)}finally{this.isPricing=!1}}}hasGroupSelection(e){return this.safeOptions.filter(r=>r.group_id===e).some(r=>this.selections[r.id]>0)}getGroupSelections(e){return this.safeOptions.filter(r=>r.group_id===e&&this.selections[r.id]>0).map(r=>({...r,quantity:this.selections[r.id]}))}isOptionAvailable(e){return this.availableOptions.length?this.availableOptions.includes(e):!0}isOptionSelected(e){return this.selections[e]>0}getOptionQuantity(e){return this.selections[e]||0}toggleGroup(e){const i=new Set(this.expandedGroups);i.has(e)?i.delete(e):i.add(e),this.expandedGroups=i}isGroupExpanded(e){return this.expandedGroups.has(e)}exportConfiguration(){const e=this.safeOptions,i=Object.entries(this.selections).filter(([r,n])=>n>0).map(([r,n])=>{const s=e.find(l=>l.id===r);return{option_id:r,option_name:s?.name,quantity:n,unit_price:s?.price||0,total_price:(s?.price||0)*n}});return{id:this.configurationId,model_id:this.modelId,model_name:this.model?.name,selections:i,validation:{is_valid:this.isValid,violations:this.validationResults?.violations||[]},pricing:{base_price:this.basePrice,total_price:this.totalPrice,discounts:this.discounts,breakdown:this.pricingData?.breakdown||[]},metadata:{created:this.configuration?.created_at,updated:this.configuration?.updated_at,saved:this.lastSaved}}}reset(){this.selections={},this.validationResults=null,this.pricingData=null,this.configuration=null,this.configurationId=null,this.currentStep=0,this.isDirty=!1,this.error=null,this.validationErrors=[]}_debounce(e,i,r){clearTimeout(this._debounceTimers.get(e)),this._debounceTimers.set(e,setTimeout(i,r))}canProceedToStep(e){switch(e){case 1:return this.selectedCount>0;case 2:return this.isValid;case 3:return this.isValid&&this.pricingData;default:return!0}}nextStep(){this.currentStep<3&&this.canProceedToStep(this.currentStep+1)&&this.currentStep++}previousStep(){this.currentStep>0&&this.currentStep--}goToStep(e){e>=0&&e<=3&&this.canProceedToStep(e)&&(this.currentStep=e)}setModelId(e){this.modelId!==e&&(this.reset(),this.modelId=e)}}Rt=new WeakMap,Mt=new WeakMap,Vt=new WeakMap,Lt=new WeakMap,Nt=new WeakMap,zt=new WeakMap,Ft=new WeakMap,Ut=new WeakMap,jt=new WeakMap,Gt=new WeakMap,Bt=new WeakMap,Ht=new WeakMap,Qt=new WeakMap,Yt=new WeakMap,Wt=new WeakMap,Kt=new WeakMap,Jt=new WeakMap,Zt=new WeakMap,Xt=new WeakMap,$t=new WeakMap,ei=new WeakMap,ti=new WeakMap,ii=new WeakMap,ri=new WeakMap;const p=new hs;var gs=Yn('<svg class="checkmark svelte-19ib3n" width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z"></path></svg>'),ps=h('<span class="step-number svelte-19ib3n"></span>'),ms=h('<div><div class="step-marker svelte-19ib3n"><!></div> <div class="step-content svelte-19ib3n"><span class="step-icon svelte-19ib3n"> </span> <span class="step-label svelte-19ib3n"> </span></div></div>'),bs=h('<div class="progress-indicator svelte-19ib3n"><div class="progress-bar svelte-19ib3n"><div class="progress-fill svelte-19ib3n"></div></div> <div class="steps svelte-19ib3n"></div></div>');function ys(t,e){$e(e,!0);let i=Z(e,"steps",19,()=>[]),r=Z(e,"currentStep",3,0),n=Z(e,"onStepClick",3,null),s=Z(e,"canNavigate",3,!1);function l(c){s()&&n()&&c<=r()&&n()(c)}function v(c){return c<r()?"completed":c===r()?"active":"pending"}var d=bs(),_=a(d),S=a(_),b=u(_,2);Ue(b,21,i,Qe,(c,g,w)=>{var O=ms();const M=me(()=>v(w)),A=me(()=>s()&&w<=r());let x;O.__click=()=>l(w),O.__keydown=j=>{o(A)&&(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),l(w))};var T=a(O),I=a(T);{var C=j=>{var _e=gs();f(j,_e)},se=j=>{var _e=ps();_e.textContent=w+1,f(j,_e)};m(I,j=>{o(M)==="completed"?j(C):j(se,!1)})}var re=u(T,2),ne=a(re),Pe=a(ne),Ae=u(ne,2),V=a(Ae);k(j=>{x=xe(O,1,`step ${o(M)??""}`,"svelte-19ib3n",x,j),pt(O,"role",o(A)?"button":"presentation"),pt(O,"tabindex",o(A)?0:-1),y(Pe,o(g).icon),y(V,o(g).label)},[()=>({clickable:o(A)})]),f(c,O)}),k(()=>ns(S,`width: ${r()===0?0:r()/(i().length-1)*100}%`)),f(t,d),et()}ht(["click","keydown"]);var ws=h('<p class="loading-message svelte-121gmln"> </p>'),Ss=h('<div class="loading-overlay svelte-121gmln"><div class="loading-content svelte-121gmln"><div></div> <!></div></div>'),xs=h('<p class="loading-message svelte-121gmln"> </p>'),ks=h('<div class="loading-container svelte-121gmln"><div></div> <!></div>');function ai(t,e){$e(e,!0);let i=Z(e,"size",3,"medium"),r=Z(e,"message",3,""),n=Z(e,"overlay",3,!1),s=Z(e,"color",3,"primary"),l=me(()=>({small:"w-4 h-4 border-2",medium:"w-8 h-8 border-3",large:"w-12 h-12 border-4"})[i()]||"w-8 h-8 border-3"),v=me(()=>({primary:"border-blue-600 border-t-transparent",white:"border-white border-t-transparent",gray:"border-gray-600 border-t-transparent"})[s()]||"border-blue-600 border-t-transparent");var d=vt(),_=Ke(d);{var S=c=>{var g=Ss(),w=a(g),O=a(w),M=u(O,2);{var A=x=>{var T=ws(),I=a(T);k(()=>y(I,r())),f(x,T)};m(M,x=>{r()&&x(A)})}k(()=>xe(O,1,`spinner ${o(l)??""} ${o(v)??""}`,"svelte-121gmln")),f(c,g)},b=c=>{var g=ks(),w=a(g),O=u(w,2);{var M=A=>{var x=xs(),T=a(x);k(()=>y(T,r())),f(A,x)};m(O,A=>{r()&&A(M)})}k(()=>xe(w,1,`spinner ${o(l)??""} ${o(v)??""}`,"svelte-121gmln")),f(c,g)};m(_,c=>{n()?c(S):c(b,!1)})}f(t,d),et()}var Es=()=>location.reload(),As=h('<div class="error-boundary svelte-szpq5s"><div class="error-content svelte-szpq5s"><div class="error-icon svelte-szpq5s">⚠️</div> <h2 class="error-title svelte-szpq5s">Something went wrong</h2> <p class="error-message svelte-szpq5s"> </p> <!> <div class="error-actions svelte-szpq5s"><button class="btn btn-primary svelte-szpq5s">Try Again</button> <button class="btn btn-secondary svelte-szpq5s">Reload Page</button></div></div></div>');function Cs(t,e){$e(e,!0);let i=Z(e,"fallback",3,null),r=Z(e,"onError",3,null),n=H(null),s=H(!1);function l(c){console.error("ErrorBoundary caught:",c.error),z(n,c.error,!0),z(s,!0),r()&&r()(c.error),c.preventDefault(),c.stopPropagation()}function v(){z(n,null),z(s,!1)}Ti(()=>(window.addEventListener("error",l),window.addEventListener("unhandledrejection",c=>{l({error:c.reason})}),()=>{window.removeEventListener("error",l),window.removeEventListener("unhandledrejection",l)}));var d=vt(),_=Ke(d);{var S=c=>{var g=vt(),w=Ke(g);{var O=A=>{var x=vt(),T=Ke(x);Dr(T,i,()=>o(n),()=>v),f(A,x)},M=A=>{var x=As(),T=a(x),I=u(a(T),4),C=a(I),se=u(I,2);m(se,Ae=>{});var re=u(se,2),ne=a(re);ne.__click=v;var Pe=u(ne,2);Pe.__click=[Es],k(()=>y(C,o(n)?.message||"An unexpected error occurred")),f(A,x)};m(w,A=>{i()?A(O):A(M,!1)})}f(c,g)},b=c=>{var g=vt(),w=Ke(g);Dr(w,()=>e.children),f(c,g)};m(_,c=>{o(s)?c(S):c(b,!1)})}f(t,d),et()}ht(["click"]);var Is=h("<p> </p>"),Ts=h("<h1> </h1>"),Ps=h("<h2> </h2>"),Ds=h("<h3> </h3>"),Os=h("<h4> </h4>"),qs=h("<div> </div>"),Rs=h("<span> </span>");function Wi(t,e){$e(e,!0);let i=Z(e,"text",3,""),r=Z(e,"fallback",3,""),n=Z(e,"tag",3,"span"),s=Z(e,"class",3,""),l=me(()=>Nr(i(),r()));var v=vt(),d=Ke(v);{var _=b=>{var c=Is(),g=a(c);k(()=>{xe(c,1,kt(s())),y(g,o(l))}),f(b,c)},S=(b,c)=>{{var g=O=>{var M=Ts(),A=a(M);k(()=>{xe(M,1,kt(s())),y(A,o(l))}),f(O,M)},w=(O,M)=>{{var A=T=>{var I=Ps(),C=a(I);k(()=>{xe(I,1,kt(s())),y(C,o(l))}),f(T,I)},x=(T,I)=>{{var C=re=>{var ne=Ds(),Pe=a(ne);k(()=>{xe(ne,1,kt(s())),y(Pe,o(l))}),f(re,ne)},se=(re,ne)=>{{var Pe=V=>{var j=Os(),_e=a(j);k(()=>{xe(j,1,kt(s())),y(_e,o(l))}),f(V,j)},Ae=(V,j)=>{{var _e=ce=>{var ke=qs(),Oe=a(ke);k(()=>{xe(ke,1,kt(s())),y(Oe,o(l))}),f(ce,ke)},Le=ce=>{var ke=Rs(),Oe=a(ke);k(()=>{xe(ke,1,kt(s())),y(Oe,o(l))}),f(ce,ke)};m(V,ce=>{n()==="div"?ce(_e):ce(Le,!1)},j)}};m(re,V=>{n()==="h4"?V(Pe):V(Ae,!1)},ne)}};m(T,re=>{n()==="h3"?re(C):re(se,!1)},I)}};m(O,T=>{n()==="h2"?T(A):T(x,!1)},M)}};m(b,O=>{n()==="h1"?O(g):O(w,!1)},c)}};m(d,b=>{n()==="p"?b(_):b(S,!1)})}f(t,v),et()}function Ms(t,e,i){e(i()+1)}function Vs(t,e,i){e(i()-1)}var Ls=(t,e)=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e())},Ns=t=>t.stopPropagation(),zs=h('<input type="radio" class="radio-input svelte-1ll8uv2"/>'),Fs=t=>t.stopPropagation(),Us=h('<input type="checkbox" class="checkbox-input svelte-1ll8uv2"/>'),js=h('<span class="option-sku svelte-1ll8uv2"> </span>'),Gs=h('<span class="total-price svelte-1ll8uv2"> </span>'),Bs=h('<li class="svelte-1ll8uv2"><!></li>'),Hs=h('<ul class="option-features svelte-1ll8uv2"></ul>'),Qs=t=>t.stopPropagation(),Ys=(t,e)=>e(parseInt(t.target.value)||0),Ws=t=>t.stopPropagation(),Ks=h('<div class="quantity-controls svelte-1ll8uv2"><label class="quantity-label svelte-1ll8uv2">Quantity:</label> <div class="quantity-input svelte-1ll8uv2"><button class="qty-btn svelte-1ll8uv2" aria-label="Decrease quantity">−</button> <input type="number" min="1" class="qty-value svelte-1ll8uv2"/> <button class="qty-btn svelte-1ll8uv2" aria-label="Increase quantity">+</button></div></div>'),Js=h('<div class="unavailable-message svelte-1ll8uv2">Not available with current selections</div>'),Zs=h('<div class="disabled-message svelte-1ll8uv2">Maximum selections reached for this group</div>'),Xs=h('<div role="button"><div class="option-header svelte-1ll8uv2"><!> <div class="option-info svelte-1ll8uv2"><!> <!></div> <div class="option-price svelte-1ll8uv2"><span class="price svelte-1ll8uv2"> </span> <!></div></div> <!> <!> <!> <!> <!></div>');function $s(t,e){$e(e,!0);let i=Z(e,"selected",3,!1),r=Z(e,"quantity",3,0),n=Z(e,"disabled",3,!1),s=Z(e,"available",3,!0),l=Z(e,"selectionType",3,"multiple"),v=Z(e,"maxQuantity",3,10);function d(){n()||(l(),e.onChange(i()?0:1))}function _(E){if(n())return;const R=Math.max(0,Math.min(E,v()));e.onChange(R)}let S=me(()=>e.option.price?`$${e.option.price.toFixed(2)}`:"Included"),b=me(()=>r()>1&&e.option.price?`$${(e.option.price*r()).toFixed(2)} total`:"");var c=Xs();let g;c.__click=function(...E){(l()==="single"?d:void 0)?.apply(this,E)},c.__keydown=[Ls,d];var w=a(c),O=a(w);{var M=E=>{var R=zs();R.__change=d,R.__click=[Ns],k(()=>{Rr(R,i()),R.disabled=n()}),f(E,R)},A=E=>{var R=Us();R.__change=d,R.__click=[Fs],k(()=>{Rr(R,i()),R.disabled=n()}),f(E,R)};m(O,E=>{l()==="single"?E(M):E(A,!1)})}var x=u(O,2),T=a(x);Wi(T,{get text(){return e.option.name},fallback:"Unnamed Option",tag:"h4",class:"option-name"});var I=u(T,2);{var C=E=>{var R=js(),ve=a(R);k(()=>y(ve,`SKU: ${e.option.sku??""}`)),f(E,R)};m(I,E=>{e.option.sku&&E(C)})}var se=u(x,2),re=a(se),ne=a(re),Pe=u(re,2);{var Ae=E=>{var R=Gs(),ve=a(R);k(()=>y(ve,o(b))),f(E,R)};m(Pe,E=>{o(b)&&E(Ae)})}var V=u(w,2);{var j=E=>{Wi(E,{get text(){return e.option.description},tag:"p",class:"option-description"})};m(V,E=>{e.option.description&&E(j)})}var _e=u(V,2);{var Le=E=>{var R=Hs();Ue(R,21,()=>e.option.features,Qe,(ve,B)=>{var Y=Bs(),be=a(Y);Wi(be,{get text(){return o(B)},tag:"span"}),f(ve,Y)}),f(E,R)};m(_e,E=>{e.option.features&&e.option.features.length>0&&E(Le)})}var ce=u(_e,2);{var ke=E=>{var R=Ks();R.__click=[Qs];var ve=u(a(R),2),B=a(ve);B.__click=[Vs,_,r];var Y=u(B,2);Y.__change=[Ys,_],Y.__click=[Ws];var be=u(Y,2);be.__click=[Ms,_,r],k(()=>{B.disabled=n()||r()<=1,os(Y,r()),pt(Y,"max",v()),Y.disabled=n(),be.disabled=n()||r()>=v()}),f(E,R)};m(ce,E=>{l()==="multiple"&&i()&&E(ke)})}var Oe=u(ce,2);{var P=E=>{var R=Js();f(E,R)};m(Oe,E=>{!s()&&!n()&&E(P)})}var X=u(Oe,2);{var L=E=>{var R=Zs();f(E,R)};m(X,E=>{n()&&s()&&E(L)})}k(E=>{g=xe(c,1,"option-card svelte-1ll8uv2",null,g,E),pt(c,"tabindex",n()?-1:0),y(ne,o(S))},[()=>({selected:i(),disabled:n(),unavailable:!s()})]),f(t,c),et()}ht(["click","keydown","change"]);var ea=h('<span class="required svelte-99mz6y">*</span>'),ta=h('<p class="group-description svelte-99mz6y"> </p>'),ia=h('<span class="selection-count svelte-99mz6y"> <!></span>'),ra=h('<div class="options-grid svelte-99mz6y"></div>'),na=h('<div class="no-options svelte-99mz6y"><p>No options available in this group.</p></div>'),sa=h('<div class="group-content svelte-99mz6y"><!></div>'),aa=h('<div><div class="group-header svelte-99mz6y"><div class="group-info svelte-99mz6y"><h3 class="group-name svelte-99mz6y"> <!></h3> <!></div> <div class="group-meta svelte-99mz6y"><div class="selection-info svelte-99mz6y"><span class="selection-type svelte-99mz6y"> </span> <!></div> <button class="expand-toggle svelte-99mz6y"><svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div></div> <!></div>');function oa(t,e){$e(e,!0);let i=Z(e,"options",19,()=>[]),r=Z(e,"selections",19,()=>({})),n=Z(e,"availableOptions",19,()=>[]),s=Z(e,"expanded",3,!0),l=me(()=>Array.isArray(i())?i().filter(P=>r()[P.id]>0).length:0),v=me(()=>Array.isArray(i())?i().reduce((P,X)=>P+(r()[X.id]||0),0):0);function d(){return e.group.selection_type==="single"?"Select one":e.group.selection_type==="multiple"?e.group.min_selections&&e.group.max_selections?e.group.min_selections===e.group.max_selections?`Select exactly ${e.group.min_selections}`:`Select ${e.group.min_selections}-${e.group.max_selections}`:e.group.min_selections?`Select at least ${e.group.min_selections}`:e.group.max_selections?`Select up to ${e.group.max_selections}`:"Select multiple":""}let _=Me(d());Ti(()=>{const P=d();(P.includes("=>")||P.includes("function"))&&console.error("[OptionGroup] Selection text contains code!",{text:P,group:e.group})});function S(P,X){e.group.selection_type==="single"&&X>0&&Array.isArray(i())&&i().forEach(L=>{L.id!==P&&r()[L.id]>0&&e.onSelectionChange(L.id,0)}),!(e.group.max_selections&&X>0&&Array.isArray(i())&&i().filter(E=>E.id!==P&&r()[E.id]>0).length>=e.group.max_selections)&&e.onSelectionChange(P,X)}function b(P){return!!(n().length>0&&!n().includes(P.id)||e.group.max_selections&&!r()[P.id]&&i().filter(L=>r()[L.id]>0).length>=e.group.max_selections)}function c(P){const X=r()[P.id]>0,L=n().length===0||n().includes(P.id),E=b(P);return{selected:X,available:L,disabled:E,quantity:r()[P.id]||0}}var g=aa();let w;var O=a(g);O.__click=function(...P){e.onToggle?.apply(this,P)};var M=a(O),A=a(M),x=a(A),T=u(x);{var I=P=>{var X=ea();f(P,X)};m(T,P=>{e.group.required&&P(I)})}var C=u(A,2);{var se=P=>{var X=ta(),L=a(X);k(()=>y(L,e.group.description)),f(P,X)};m(C,P=>{e.group.description&&typeof e.group.description=="string"&&!e.group.description.includes("=>")&&!e.group.description.includes("function")&&!e.group.description.includes("$props")&&P(se)})}var re=u(M,2),ne=a(re),Pe=a(ne),Ae=a(Pe),V=u(Pe,2);{var j=P=>{var X=ia(),L=a(X),E=u(L);{var R=ve=>{var B=xt();k(()=>y(B,`(${o(v)??""} total)`)),f(ve,B)};m(E,ve=>{o(v)>o(l)&&ve(R)})}k(()=>y(L,`${o(l)??""} selected `)),f(P,X)};m(V,P=>{o(l)>0&&P(j)})}var _e=u(ne,2),Le=a(_e);let ce;var ke=u(O,2);{var Oe=P=>{var X=sa(),L=a(X);{var E=ve=>{var B=ra();Ue(B,21,i,Y=>Y.id,(Y,be)=>{const Ve=me(()=>c(o(be))),Ne=me(()=>o(be).max_quantity||10);$s(Y,{get option(){return o(be)},get selected(){return o(Ve).selected},get quantity(){return o(Ve).quantity},get disabled(){return o(Ve).disabled},get available(){return o(Ve).available},get selectionType(){return e.group.selection_type},get maxQuantity(){return o(Ne)},onChange:ut=>S(o(be).id,ut)})}),k(()=>pt(B,"data-selection-type",e.group.selection_type)),f(ve,B)},R=ve=>{var B=na();f(ve,B)};m(L,ve=>{Array.isArray(i())&&i().length>0?ve(E):ve(R,!1)})}f(P,X)};m(ke,P=>{s()&&P(Oe)})}k((P,X,L)=>{w=xe(g,1,"option-group svelte-99mz6y",null,w,P),y(x,`${e.group.name||"Unnamed Group"} `),y(Ae,X),pt(_e,"aria-label",s()?"Collapse":"Expand"),ce=xe(Le,0,"icon svelte-99mz6y",null,ce,L)},[()=>({expanded:s(),required:e.group.required}),()=>Nr(_,e.group.selection_type==="single"?"Select one":"Select multiple"),()=>({rotated:!s()})]),f(t,g),et()}ht(["click"]);var la=h('<div class="pricing-empty svelte-hgfbko"><p>Add options to see pricing</p></div>'),va=h('<div class="summary-row savings svelte-hgfbko"><span class="label">Total Savings</span> <span class="amount"> </span></div>'),ua=(t,e)=>z(e,!o(e)),ca=h('<button class="toggle-btn svelte-hgfbko"> <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M4.646 6.646a.5.5 0 01.708 0L8 9.293l2.646-2.647a.5.5 0 01.708.708l-3 3a.5.5 0 01-.708 0l-3-3a.5.5 0 010-.708z"></path></svg></button>'),da=h('<span class="item-quantity svelte-hgfbko"> </span>'),fa=h('<div class="line-item svelte-hgfbko"><div class="item-details svelte-hgfbko"><span class="item-name svelte-hgfbko"> </span> <!></div> <span class="item-price svelte-hgfbko"> </span></div>'),_a=h('<div class="option-group svelte-hgfbko"></div>'),ha=h('<div class="pricing-section svelte-hgfbko"><h4 class="section-title svelte-hgfbko">Selected Options</h4> <!> <div class="line-item subtotal svelte-hgfbko"><span class="item-name svelte-hgfbko">Options Subtotal</span> <span class="item-price svelte-hgfbko"> </span></div></div>'),ga=(t,e)=>z(e,!o(e)),pa=h('<span class="item-description svelte-hgfbko"> </span>'),ma=h('<div class="line-item discount svelte-hgfbko"><div class="item-details svelte-hgfbko"><span class="item-name svelte-hgfbko"> </span> <!></div> <span class="item-price discount-amount svelte-hgfbko"> </span></div>'),ba=h('<div class="pricing-section svelte-hgfbko"><h4 class="section-title svelte-hgfbko">Discounts Applied <button class="toggle-discounts svelte-hgfbko"> </button></h4> <!></div>'),ya=h('<span class="active-badge svelte-hgfbko">Active</span>'),wa=h('<div><div class="tier-range svelte-hgfbko"> <!> units</div> <div class="tier-discount svelte-hgfbko"> <!></div></div>'),Sa=h('<div class="pricing-section svelte-hgfbko"><h4 class="section-title svelte-hgfbko">Volume Pricing Tiers</h4> <div class="volume-tiers svelte-hgfbko"></div></div>'),xa=h('<div class="line-item small svelte-hgfbko"><span class="item-name svelte-hgfbko"> </span> <span class="item-price svelte-hgfbko"> </span></div>'),ka=h('<div class="pricing-section svelte-hgfbko"><h4 class="section-title svelte-hgfbko">Detailed Breakdown</h4> <div class="breakdown-items svelte-hgfbko"></div></div>'),Ea=h('<div class="pricing-section svelte-hgfbko"><h4 class="section-title svelte-hgfbko">Base Configuration</h4> <div class="line-item svelte-hgfbko"><span class="item-name svelte-hgfbko">Base Model Price</span> <span class="item-price svelte-hgfbko"> </span></div></div> <!> <!> <!> <!>',1),Aa=h('<div class="currency-note svelte-hgfbko"> </div>'),Ca=h('<div class="pricing-summary svelte-hgfbko"><div class="summary-row total svelte-hgfbko"><span class="label">Total Price</span> <span class="amount"> </span></div> <!> <!></div> <!> <div class="pricing-footer svelte-hgfbko"><div class="final-total svelte-hgfbko"><span class="label">Total</span> <span class="amount"> </span></div> <!></div>',1),Ia=h("<div><!></div>");function Ta(t,e){$e(e,!0);let i=Z(e,"selections",19,()=>({})),r=Z(e,"options",19,()=>[]),n=Z(e,"volumeTiers",19,()=>[]),s=Z(e,"detailed",3,!1),l=H(Me(s())),v=H(!0);function d(x){return Array.isArray(r())?r().find(T=>T.id===x):null}function _(x){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x||0)}let S=me(()=>()=>e.pricingData?.discounts?e.pricingData.discounts.reduce((x,T)=>x+(T.amount||0),0):0),b=me(()=>()=>{if(!e.pricingData||!o(S))return 0;const x=e.pricingData.base_price+(e.pricingData.options_total||0);return x===0?0:Math.round(o(S)/x*100)}),c=me(()=>()=>{const x=new Map;return Object.entries(i()).forEach(([T,I])=>{if(I<=0)return;const C=d(T);if(!C)return;const se=C.group_id||"other";x.has(se)||x.set(se,[]),x.get(se).push({option:C,quantity:I,lineTotal:(C.price||0)*I})}),Array.from(x.entries())});var g=Ia();let w;var O=a(g);{var M=x=>{var T=la();f(x,T)},A=x=>{var T=Ca(),I=Ke(T),C=a(I),se=u(a(C),2),re=a(se),ne=u(C,2);{var Pe=L=>{var E=va(),R=u(a(E),2),ve=a(R);k(B=>y(ve,`-${B??""} (${o(b)??""}%)`),[()=>_(o(S))]),f(L,E)};m(ne,L=>{o(S)>0&&L(Pe)})}var Ae=u(ne,2);{var V=L=>{var E=ca();E.__click=[ua,l];var R=a(E),ve=u(R);let B;k(Y=>{y(R,`${o(l)?"Hide":"Show"} Breakdown `),B=xe(ve,0,"chevron svelte-hgfbko",null,B,Y)},[()=>({rotated:o(l)})]),f(L,E)};m(Ae,L=>{s()&&L(V)})}var j=u(I,2);{var _e=L=>{var E=Ea(),R=Ke(E),ve=u(a(R),2),B=u(a(ve),2),Y=a(B),be=u(R,2);{var Ve=ae=>{var qe=ha(),D=u(a(qe),2);Ue(D,17,()=>o(c),Qe,(De,F)=>{var W=me(()=>Di(o(F),2));let U=()=>o(W)[1];var Q=_a();Ue(Q,21,U,Qe,($,oe)=>{let q=()=>o(oe).option,K=()=>o(oe).quantity,de=()=>o(oe).lineTotal;var Ee=fa(),ee=a(Ee),le=a(ee),he=a(le),J=u(le,2);{var ie=te=>{var fe=da(),ze=a(fe);k(nt=>y(ze,`×${K()??""} @ ${nt??""} each`),[()=>_(q().price)]),f(te,fe)};m(J,te=>{K()>1&&te(ie)})}var ge=u(ee,2),pe=a(ge);k(te=>{y(he,q().name),y(pe,te)},[()=>_(de())]),f($,Ee)}),f(De,Q)});var G=u(D,2),ue=u(a(G),2),ye=a(ue);k(De=>y(ye,De),[()=>_(e.pricingData.options_total||0)]),f(ae,qe)};m(be,ae=>{o(c).length>0&&ae(Ve)})}var Ne=u(be,2);{var ut=ae=>{var qe=ba(),D=a(qe),G=u(a(D));G.__click=[ga,v];var ue=a(G),ye=u(D,2);{var De=F=>{var W=vt(),U=Ke(W);Ue(U,17,()=>e.pricingData.discounts,Qe,(Q,$)=>{var oe=ma(),q=a(oe),K=a(q),de=a(K),Ee=u(K,2);{var ee=J=>{var ie=pa(),ge=a(ie);k(()=>y(ge,o($).description)),f(J,ie)};m(Ee,J=>{o($).description&&J(ee)})}var le=u(q,2),he=a(le);k(J=>{y(de,o($).name),y(he,`-${J??""}`)},[()=>_(o($).amount)]),f(Q,oe)}),f(F,W)};m(ye,F=>{o(v)&&F(De)})}k(()=>y(ue,o(v)?"Hide":"Show")),f(ae,qe)};m(Ne,ae=>{e.pricingData.discounts?.length>0&&ae(ut)})}var ct=u(Ne,2);{var Et=ae=>{var qe=Sa(),D=u(a(qe),2);Ue(D,21,n,Qe,(G,ue)=>{var ye=wa();const De=me(()=>e.pricingData.active_tier?.id===o(ue).id);let F;var W=a(ye),U=a(W),Q=u(U);{var $=ee=>{var le=xt();k(()=>y(le,`- ${o(ue).max_quantity??""}`)),f(ee,le)},oe=ee=>{var le=xt("+");f(ee,le)};m(Q,ee=>{o(ue).max_quantity?ee($):ee(oe,!1)})}var q=u(W,2),K=a(q),de=u(K);{var Ee=ee=>{var le=ya();f(ee,le)};m(de,ee=>{o(De)&&ee(Ee)})}k(ee=>{F=xe(ye,1,"tier-item svelte-hgfbko",null,F,ee),y(U,`${o(ue).min_quantity??""} `),y(K,`${o(ue).discount_percent??""}% off `)},[()=>({active:o(De)})]),f(G,ye)}),f(ae,qe)};m(ct,ae=>{n().length>0&&s()&&ae(Et)})}var mt=u(ct,2);{var Re=ae=>{var qe=ka(),D=u(a(qe),2);Ue(D,21,()=>e.pricingData.breakdown,Qe,(G,ue)=>{var ye=xa(),De=a(ye),F=a(De),W=u(De,2),U=a(W);k(Q=>{y(F,o(ue).name),y(U,Q)},[()=>_(o(ue).amount)]),f(G,ye)}),f(ae,qe)};m(mt,ae=>{e.pricingData.breakdown&&s()&&ae(Re)})}k(ae=>y(Y,ae),[()=>_(e.pricingData.base_price)]),f(L,E)};m(j,L=>{o(l)&&L(_e)})}var Le=u(j,2),ce=a(Le),ke=u(a(ce),2),Oe=a(ke),P=u(ce,2);{var X=L=>{var E=Aa(),R=a(E);k(()=>y(R,`Prices shown in ${e.pricingData.currency??""}`)),f(L,E)};m(P,L=>{e.pricingData.currency&&e.pricingData.currency!=="USD"&&L(X)})}k((L,E)=>{y(re,L),y(Oe,E)},[()=>_(e.pricingData.total_price),()=>_(e.pricingData.total_price)]),f(x,T)};m(O,x=>{e.pricingData?x(A,!1):x(M)})}k(x=>w=xe(g,1,"pricing-display svelte-hgfbko",null,w,x),[()=>({detailed:s()})]),f(t,g),et()}ht(["click"]);var Pa=h('<div class="validation-success svelte-5l87sd"><div class="success-icon svelte-5l87sd">✅</div> <div class="success-content svelte-5l87sd"><h3 class="svelte-5l87sd">Configuration Valid</h3> <p class="svelte-5l87sd">All constraints are satisfied. Your configuration is ready.</p></div></div>'),Da=(t,e)=>z(e,"all"),Oa=(t,e)=>z(e,"critical"),qa=h("<button> </button>"),Ra=(t,e)=>z(e,"warning"),Ma=h("<button> </button>"),Va=(t,e)=>z(e,"info"),La=h("<button> </button>"),Na=h('<div class="validation-header svelte-5l87sd"><h3 class="svelte-5l87sd"> </h3> <div class="severity-filters svelte-5l87sd"><button> </button> <!> <!> <!></div></div>'),za=h('<div class="violation-rule svelte-5l87sd"> </div>'),Fa=(t,e,i)=>{t.stopPropagation(),e(o(i))},Ua=h('<button class="fix-btn svelte-5l87sd" title="Apply suggested fix">Fix</button>'),ja=h('<div class="detail-section svelte-5l87sd"><h4 class="svelte-5l87sd">Details</h4> <p class="svelte-5l87sd"> </p></div>'),Ga=h("<li> </li>"),Ba=h('<div class="detail-section svelte-5l87sd"><h4 class="svelte-5l87sd">Affected Options</h4> <ul class="affected-list svelte-5l87sd"></ul></div>'),Ha=h(" <!>",1),Qa=(t,e,i)=>e.onFix(o(i)),Ya=h('<button class="apply-btn svelte-5l87sd">Apply</button>'),Wa=h('<div class="suggestion svelte-5l87sd"><span class="suggestion-text"><!></span> <!></div>'),Ka=h('<div class="detail-section svelte-5l87sd"><h4 class="svelte-5l87sd">Suggested Actions</h4> <div class="suggestions svelte-5l87sd"></div></div>'),Ja=h('<div class="detail-section svelte-5l87sd"><h4 class="svelte-5l87sd">Rule Expression</h4> <code class="expression svelte-5l87sd"> </code></div>'),Za=h('<div class="violation-details svelte-5l87sd"><!> <!> <!> <!></div>'),Xa=h('<div><div class="violation-header svelte-5l87sd"><div class="violation-icon svelte-5l87sd"> </div> <div class="violation-content svelte-5l87sd"><div class="violation-message svelte-5l87sd"> </div> <!></div> <div class="violation-actions svelte-5l87sd"><!> <button class="expand-btn svelte-5l87sd"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M4.646 6.646a.5.5 0 01.708 0L8 9.293l2.646-2.647a.5.5 0 01.708.708l-3 3a.5.5 0 01-.708 0l-3-3a.5.5 0 010-.708z"></path></svg></button></div></div> <!></div>'),$a=h('<!> <div class="violations-list svelte-5l87sd"></div>',1),eo=h('<div class="validation-empty svelte-5l87sd"><p>Validating configuration...</p></div>'),to=h("<div><!></div>");function zr(t,e){$e(e,!0);let i=Z(e,"compact",3,!1),r=H(Me(new Set)),n=H("all"),s=me(()=>e.validationResults?.violations||[]),l=me(()=>()=>o(n)==="all"?o(s):o(s).filter(A=>A.severity===o(n))),v=me(()=>()=>{const A={critical:0,warning:0,info:0};return o(s).forEach(x=>{A[x.severity||"warning"]++}),A});function d(A){const x=new Set(o(r));x.has(A)?x.delete(A):x.add(A),z(r,x,!0)}function _(A){switch(A){case"critical":return"🚫";case"warning":return"⚠️";case"info":return"ℹ️";default:return"⚠️"}}function S(A){switch(A){case"critical":return"error";case"warning":return"warning";case"info":return"info";default:return"warning"}}function b(A){e.onFix&&A.suggestions?.length>0&&e.onFix(A.suggestions[0])}var c=to();let g;var w=a(c);{var O=A=>{var x=Pa();f(A,x)},M=(A,x)=>{{var T=C=>{var se=$a(),re=Ke(se);{var ne=Ae=>{var V=Na(),j=a(V),_e=a(j),Le=u(j,2),ce=a(Le);let ke;ce.__click=[Da,n];var Oe=a(ce),P=u(ce,2);{var X=B=>{var Y=qa();let be;Y.__click=[Oa,n];var Ve=a(Y);k(Ne=>{be=xe(Y,1,"filter-btn critical svelte-5l87sd",null,be,Ne),y(Ve,`Critical (${o(v).critical??""})`)},[()=>({active:o(n)==="critical"})]),f(B,Y)};m(P,B=>{o(v).critical>0&&B(X)})}var L=u(P,2);{var E=B=>{var Y=Ma();let be;Y.__click=[Ra,n];var Ve=a(Y);k(Ne=>{be=xe(Y,1,"filter-btn warning svelte-5l87sd",null,be,Ne),y(Ve,`Warning (${o(v).warning??""})`)},[()=>({active:o(n)==="warning"})]),f(B,Y)};m(L,B=>{o(v).warning>0&&B(E)})}var R=u(L,2);{var ve=B=>{var Y=La();let be;Y.__click=[Va,n];var Ve=a(Y);k(Ne=>{be=xe(Y,1,"filter-btn info svelte-5l87sd",null,be,Ne),y(Ve,`Info (${o(v).info??""})`)},[()=>({active:o(n)==="info"})]),f(B,Y)};m(R,B=>{o(v).info>0&&B(ve)})}k(B=>{y(_e,`Validation Issues (${o(s).length??""})`),ke=xe(ce,1,"filter-btn svelte-5l87sd",null,ke,B),y(Oe,`All (${o(s).length??""})`)},[()=>({active:o(n)==="all"})]),f(Ae,V)};m(re,Ae=>{i()||Ae(ne)})}var Pe=u(re,2);Ue(Pe,21,()=>o(l),Qe,(Ae,V,j)=>{var _e=Xa();const Le=me(()=>o(r).has(o(V).rule_id||j)),ce=me(()=>S(o(V).severity));let ke;var Oe=a(_e);Oe.__click=()=>d(o(V).rule_id||j);var P=a(Oe),X=a(P),L=u(P,2),E=a(L),R=a(E),ve=u(E,2);{var B=Re=>{var ae=za(),qe=a(ae);k(()=>y(qe,`Rule: ${o(V).rule_name??""}`)),f(Re,ae)};m(ve,Re=>{o(V).rule_name&&!i()&&Re(B)})}var Y=u(L,2),be=a(Y);{var Ve=Re=>{var ae=Ua();ae.__click=[Fa,b,V],f(Re,ae)};m(be,Re=>{o(V).suggestions?.length>0&&e.onFix&&Re(Ve)})}var Ne=u(be,2),ut=a(Ne);let ct;var Et=u(Oe,2);{var mt=Re=>{var ae=Za(),qe=a(ae);{var D=U=>{var Q=ja(),$=u(a(Q),2),oe=a($);k(()=>y(oe,o(V).details)),f(U,Q)};m(qe,U=>{o(V).details&&U(D)})}var G=u(qe,2);{var ue=U=>{var Q=Ba(),$=u(a(Q),2);Ue($,21,()=>o(V).affected_options,Qe,(oe,q)=>{var K=Ga(),de=a(K);k(()=>y(de,o(q).name||o(q).id)),f(oe,K)}),f(U,Q)};m(G,U=>{o(V).affected_options?.length>0&&U(ue)})}var ye=u(G,2);{var De=U=>{var Q=Ka(),$=u(a(Q),2);Ue($,21,()=>o(V).suggestions,Qe,(oe,q)=>{var K=Wa(),de=a(K),Ee=a(de);{var ee=ie=>{var ge=Ha(),pe=Ke(ge),te=u(pe);{var fe=ze=>{var nt=xt();k(()=>y(nt,`(×${o(q).quantity??""})`)),f(ze,nt)};m(te,ze=>{o(q).quantity>1&&ze(fe)})}k(()=>y(pe,`Add: ${(o(q).option_name||o(q).option_id)??""} `)),f(ie,ge)},le=(ie,ge)=>{{var pe=fe=>{var ze=xt();k(()=>y(ze,`Remove: ${(o(q).option_name||o(q).option_id)??""}`)),f(fe,ze)},te=(fe,ze)=>{{var nt=dt=>{var At=xt();k(()=>y(At,`Change: ${o(q).description??""}`)),f(dt,At)},Ji=dt=>{var At=xt();k(()=>y(At,o(q).description)),f(dt,At)};m(fe,dt=>{o(q).action==="change"?dt(nt):dt(Ji,!1)},ze)}};m(ie,fe=>{o(q).action==="remove"?fe(pe):fe(te,!1)},ge)}};m(Ee,ie=>{o(q).action==="add"?ie(ee):ie(le,!1)})}var he=u(de,2);{var J=ie=>{var ge=Ya();ge.__click=[Qa,e,q],f(ie,ge)};m(he,ie=>{e.onFix&&ie(J)})}f(oe,K)}),f(U,Q)};m(ye,U=>{o(V).suggestions?.length>0&&U(De)})}var F=u(ye,2);{var W=U=>{var Q=Ja(),$=u(a(Q),2),oe=a($);k(()=>y(oe,o(V).rule_expression)),f(U,Q)};m(F,U=>{o(V).rule_expression&&!i()&&U(W)})}f(Re,ae)};m(Et,Re=>{o(Le)&&Re(mt)})}k((Re,ae,qe)=>{ke=xe(_e,1,`violation-item ${o(ce)??""}`,"svelte-5l87sd",ke,Re),y(X,ae),y(R,o(V).message),pt(Ne,"aria-label",o(Le)?"Collapse":"Expand"),ct=xe(ut,0,"chevron svelte-5l87sd",null,ct,qe)},[()=>({expanded:o(Le)}),()=>_(o(V).severity),()=>({rotated:o(Le)})]),f(Ae,_e)}),f(C,se)},I=C=>{var se=eo();f(C,se)};m(A,C=>{o(s).length>0?C(T):C(I,!1)},x)}};m(w,A=>{e.validationResults?.is_valid?A(O):A(M,!1)})}k(A=>g=xe(c,1,"validation-display svelte-5l87sd",null,g,A),[()=>({compact:i()})]),f(t,c),et()}ht(["click"]);var io=h('<span class="status-badge valid svelte-onht75">✅ Valid</span>'),ro=h('<span class="status-badge invalid svelte-onht75">⚠️ Issues</span>'),no=(t,e)=>e.onEdit(0),so=h('<button class="edit-btn svelte-onht75">Edit Selections</button>'),ao=h('<span class="item-quantity svelte-onht75"> </span>'),oo=h('<div class="selection-item svelte-onht75"><div class="item-info svelte-onht75"><span class="item-name svelte-onht75"> </span> <!></div> <span class="item-price svelte-onht75"> </span></div>'),lo=h('<div class="selection-group svelte-onht75"><h5 class="group-name svelte-onht75"> </h5> <div class="group-items svelte-onht75"></div></div>'),vo=h('<div class="selections-list svelte-onht75"></div>'),uo=h('<p class="empty-message svelte-onht75">No options selected</p>'),co=(t,e)=>e.onEdit(1),fo=h('<button class="edit-btn svelte-onht75">Review Issues</button>'),_o=h('<div class="violation-summary svelte-onht75"><span class="violation-icon svelte-onht75"> </span> <span class="violation-text svelte-onht75"> </span></div>'),ho=h('<p class="more-violations svelte-onht75"> </p>'),go=h('<div class="summary-section svelte-onht75"><div class="section-header svelte-onht75"><h4 class="section-title validation-title svelte-onht75"> </h4> <!></div> <div class="violations-summary svelte-onht75"><!> <!></div></div>'),po=(t,e)=>e.onEdit(2),mo=h('<button class="edit-btn svelte-onht75">View Details</button>'),bo=h('<div class="price-line discount svelte-onht75"><span class="label">Discounts Applied</span> <span class="value"> </span></div>'),yo=()=>window.print(),wo=h('<div class="configuration-summary svelte-onht75"><div class="summary-header svelte-onht75"><div class="header-info svelte-onht75"><h3 class="svelte-onht75">Configuration Summary</h3> <p class="config-id svelte-onht75"> </p></div> <div class="header-status"><!></div></div> <div class="summary-section svelte-onht75"><h4 class="section-title svelte-onht75">Product Model</h4> <div class="info-grid svelte-onht75"><div class="info-item svelte-onht75"><span class="label svelte-onht75">Model</span> <span class="value svelte-onht75"> </span></div> <div class="info-item svelte-onht75"><span class="label svelte-onht75">Created</span> <span class="value svelte-onht75"> </span></div> <div class="info-item svelte-onht75"><span class="label svelte-onht75">Last Updated</span> <span class="value svelte-onht75"> </span></div></div></div> <div class="summary-section svelte-onht75"><div class="section-header svelte-onht75"><h4 class="section-title svelte-onht75"> </h4> <!></div> <!></div> <!> <div class="summary-section svelte-onht75"><div class="section-header svelte-onht75"><h4 class="section-title svelte-onht75">Pricing Summary</h4> <!></div> <div class="pricing-summary svelte-onht75"><div class="price-line svelte-onht75"><span class="label">Base Price</span> <span class="value"> </span></div> <!> <div class="price-line total svelte-onht75"><span class="label">Total Price</span> <span class="value"> </span></div></div></div> <div class="summary-actions svelte-onht75"><button class="action-btn secondary svelte-onht75"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M5 3V1h6v2H5zM4 3H2.5A1.5 1.5 0 001 4.5V10h2V8h10v2h2V4.5A1.5 1.5 0 0013.5 3H12v2H4V3zm9 7h-2v4H5v-4H3v4.5A1.5 1.5 0 004.5 16h7a1.5 1.5 0 001.5-1.5V10z"></path></svg> Print Summary</button> <button class="action-btn secondary svelte-onht75"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M2 2a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H4a2 2 0 01-2-2V2zm10-1H4a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V2a1 1 0 00-1-1z"></path><path d="M8 3.5a.5.5 0 01.5.5v4.793l1.146-1.147a.5.5 0 01.708.708l-2 2a.5.5 0 01-.708 0l-2-2a.5.5 0 11.708-.708L7.5 8.793V4a.5.5 0 01.5-.5z"></path></svg> Export Configuration</button></div></div>');function So(t,e){$e(e,!0);function i(D){return D?new Date(D).toLocaleString():"N/A"}function r(D){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D||0)}let n=me(()=>()=>{const D=new Map;return Array.isArray(e.configuration?.selections)&&e.configuration.selections.forEach(G=>{const ue=G.group_name||"Other Options";D.has(ue)||D.set(ue,[]),D.get(ue).push(G)}),Array.from(D.entries())});var s=wo(),l=a(s),v=a(l),d=u(a(v),2),_=a(d),S=u(v,2),b=a(S);{var c=D=>{var G=io();f(D,G)},g=D=>{var G=ro();f(D,G)};m(b,D=>{e.configuration?.validation?.is_valid?D(c):D(g,!1)})}var w=u(l,2),O=u(a(w),2),M=a(O),A=u(a(M),2),x=a(A),T=u(M,2),I=u(a(T),2),C=a(I),se=u(T,2),re=u(a(se),2),ne=a(re),Pe=u(w,2),Ae=a(Pe),V=a(Ae),j=a(V),_e=u(V,2);{var Le=D=>{var G=so();G.__click=[no,e],f(D,G)};m(_e,D=>{e.onEdit&&D(Le)})}var ce=u(Ae,2);{var ke=D=>{var G=vo();Ue(G,21,()=>o(n),Qe,(ue,ye)=>{var De=me(()=>Di(o(ye),2));let F=()=>o(De)[0],W=()=>o(De)[1];var U=lo(),Q=a(U),$=a(Q),oe=u(Q,2);Ue(oe,21,W,Qe,(q,K)=>{var de=oo(),Ee=a(de),ee=a(Ee),le=a(ee),he=u(ee,2);{var J=pe=>{var te=ao(),fe=a(te);k(()=>y(fe,`×${o(K).quantity??""}`)),f(pe,te)};m(he,pe=>{o(K).quantity>1&&pe(J)})}var ie=u(Ee,2),ge=a(ie);k(pe=>{y(le,o(K).option_name),y(ge,pe)},[()=>r(o(K).total_price)]),f(q,de)}),k(()=>y($,F())),f(ue,U)}),f(D,G)},Oe=D=>{var G=uo();f(D,G)};m(ce,D=>{o(n).length>0?D(ke):D(Oe,!1)})}var P=u(Pe,2);{var X=D=>{var G=go(),ue=a(G),ye=a(ue),De=a(ye),F=u(ye,2);{var W=q=>{var K=fo();K.__click=[co,e],f(q,K)};m(F,q=>{e.onEdit&&q(W)})}var U=u(ue,2),Q=a(U);Ue(Q,17,()=>e.configuration.validation.violations.slice(0,3),Qe,(q,K)=>{var de=_o(),Ee=a(de),ee=a(Ee),le=u(Ee,2),he=a(le);k(()=>{y(ee,o(K).severity==="critical"?"🚫":"⚠️"),y(he,o(K).message)}),f(q,de)});var $=u(Q,2);{var oe=q=>{var K=ho(),de=a(K);k(()=>y(de,`+${e.configuration.validation.violations.length-3} more issues`)),f(q,K)};m($,q=>{e.configuration.validation.violations.length>3&&q(oe)})}k(()=>y(De,`Validation Issues (${e.configuration.validation.violations.length??""})`)),f(D,G)};m(P,D=>{e.configuration?.validation?.violations?.length>0&&D(X)})}var L=u(P,2),E=a(L),R=u(a(E),2);{var ve=D=>{var G=mo();G.__click=[po,e],f(D,G)};m(R,D=>{e.onEdit&&D(ve)})}var B=u(E,2),Y=a(B),be=u(a(Y),2),Ve=a(be),Ne=u(Y,2);{var ut=D=>{var G=bo(),ue=u(a(G),2),ye=a(ue);k(De=>y(ye,`-${De??""}`),[()=>r(e.configuration.pricing.discounts.reduce((De,F)=>De+F.amount,0))]),f(D,G)};m(Ne,D=>{e.configuration?.pricing?.discounts?.length>0&&D(ut)})}var ct=u(Ne,2),Et=u(a(ct),2),mt=a(Et),Re=u(L,2),ae=a(Re);ae.__click=[yo];var qe=u(ae,2);qe.__click=()=>{const D=JSON.stringify(e.configuration,null,2),G=new Blob([D],{type:"application/json"}),ue=URL.createObjectURL(G),ye=document.createElement("a");ye.href=ue,ye.download=`configuration-${e.configuration?.id||"draft"}.json`,ye.click(),URL.revokeObjectURL(ue)},k((D,G,ue,ye)=>{y(_,`ID: ${e.configuration?.id||"Not saved"}`),y(x,e.configuration?.model_name||e.model?.name||"Unknown"),y(C,D),y(ne,G),y(j,`Selected Options (${(e.configuration?.selections?.length||0)??""})`),y(Ve,ue),y(mt,ye)},[()=>i(e.configuration?.metadata?.created),()=>i(e.configuration?.metadata?.updated),()=>r(e.configuration?.pricing?.base_price),()=>r(e.configuration?.pricing?.total_price)]),f(t,s),et()}ht(["click"]);function xo(t,e){z(e,!o(e))}var ko=h('<div class="loading-container svelte-7b7116"><!></div>'),Eo=()=>location.reload(),Ao=h('<div class="error-container svelte-7b7116"><div class="error-content svelte-7b7116"><div class="error-icon svelte-7b7116">⚠️</div> <h2>Configuration Error</h2> <p> </p> <button class="btn btn-primary svelte-7b7116">Reload Page</button></div></div>'),Co=h('<p class="model-description svelte-7b7116"> </p>'),Io=h('<button class="validation-indicator warning svelte-7b7116" title="View validation issues"> </button>'),To=h('<span class="save-indicator svelte-7b7116"><!> Saving...</span>'),Po=h('<span class="save-indicator saved svelte-7b7116"> </span>'),Do=h('<div class="groups-container svelte-7b7116"></div>'),Oo=h('<div class="loading-state svelte-7b7116"><!></div>'),qo=h('<div class="empty-state svelte-7b7116"><p>No option groups available for this model.</p></div>'),Ro=h('<span class="progress-text svelte-7b7116"> </span>'),Mo=h('<div class="configuration-step"><div class="step-header svelte-7b7116"><h2 class="svelte-7b7116">Select Your Options</h2> <p class="svelte-7b7116">Choose from the available options below. Required selections are marked with *</p></div> <!> <div class="step-actions svelte-7b7116"><div class="selection-summary svelte-7b7116"><span> </span> <!></div> <button class="btn btn-primary svelte-7b7116">Continue to Validation</button></div></div>'),Vo=h('<div class="validation-loading"><!></div>'),Lo=h('<div class="validation-step"><div class="step-header svelte-7b7116"><h2 class="svelte-7b7116">Configuration Validation</h2> <p class="svelte-7b7116">Review and resolve any configuration issues</p></div> <!> <!> <div class="step-actions svelte-7b7116"><button class="btn btn-secondary svelte-7b7116">Back</button> <button class="btn btn-primary svelte-7b7116"> </button></div></div>'),No=h('<div class="pricing-loading"><!></div>'),zo=h('<div class="pricing-step"><div class="step-header svelte-7b7116"><h2 class="svelte-7b7116">Pricing Details</h2> <p class="svelte-7b7116">Review your configuration pricing</p></div> <!> <!> <div class="step-actions svelte-7b7116"><button class="btn btn-secondary svelte-7b7116">Back</button> <button class="btn btn-primary svelte-7b7116">Continue to Summary</button></div></div>'),Fo=h('<div class="summary-step"><div class="step-header svelte-7b7116"><h2 class="svelte-7b7116">Configuration Summary</h2> <p class="svelte-7b7116">Review your complete configuration</p></div> <!> <div class="step-actions svelte-7b7116"><button class="btn btn-secondary svelte-7b7116">Back</button> <button class="btn btn-success svelte-7b7116"> </button></div></div>'),Uo=(t,e)=>z(e,!1),jo=h('<div><div class="panel-header svelte-7b7116"><h3 class="svelte-7b7116">Validation Issues</h3> <button class="close-btn svelte-7b7116">×</button></div> <!></div>'),Go=h('<div class="summary-item discount svelte-7b7116"><span>Discounts Applied</span> <strong class="svelte-7b7116"> </strong></div>'),Bo=h('<div class="selected-item svelte-7b7116"><span class="item-name"> </span> <span class="item-quantity svelte-7b7116"> </span></div>'),Ho=h('<div class="sidebar-section svelte-7b7116"><h3 class="svelte-7b7116">Selected Items</h3> <div class="selected-items svelte-7b7116"></div></div>'),Qo=h('<aside class="configurator-sidebar svelte-7b7116"><div class="sidebar-section svelte-7b7116"><h3 class="svelte-7b7116">Quick Summary</h3> <div class="summary-item svelte-7b7116"><span>Selected Options</span> <strong class="svelte-7b7116"> </strong></div> <div class="summary-item svelte-7b7116"><span>Total Price</span> <strong class="price svelte-7b7116"> </strong></div> <!> <div class="summary-item status svelte-7b7116"><span>Status</span> <strong> </strong></div></div> <!></aside>'),Yo=h('<div class="configurator-container svelte-7b7116"><header class="configurator-header svelte-7b7116"><div class="header-content svelte-7b7116"><h1 class="svelte-7b7116"> </h1> <!></div> <div class="header-actions svelte-7b7116"><!> <!></div></header> <!> <div class="configurator-content svelte-7b7116"><!></div> <!> <!></div>'),Wo=h("<div><!></div>");function Ko(t,e){$e(e,!0);let i=Z(e,"theme",3,"light"),r=Z(e,"apiUrl",3,"/api/v1"),n=Z(e,"embedMode",3,!1),s=Z(e,"onComplete",3,null),l=Z(e,"onConfigurationChange",3,null),v=Z(e,"onError",3,null),d=Z(e,"configurationId",3,null);const _=ds();let S=H(!1),b=H(!1),c=null;const g=[{id:"configure",label:"Configure",icon:"⚙️"},{id:"validate",label:"Validate",icon:"✅"},{id:"price",label:"Price",icon:"💰"},{id:"summary",label:"Summary",icon:"📋"}];typeof window<"u"&&(window.__API_BASE_URL__=r()),Ti(async()=>{await p.initialize(),p.setModelId(e.modelId),d()&&await p.loadConfiguration(d()),z(S,!0),document.documentElement.setAttribute("data-theme",i()),c=setInterval(()=>{p.isDirty&&p.saveConfiguration()},3e4);const C=Pn(()=>{wt(()=>{l()&&p.selectedCount>0&&l()(p.exportConfiguration())}),wt(()=>{v()&&p.error&&(v()(new Error(p.error)),_("error",{message:p.error}))})});return()=>{C(),c&&clearInterval(c)}}),us(()=>{p.isDirty&&p.saveConfiguration()});async function w(){if(await p.validateConfiguration(),!p.isValid){p.error="Please resolve all validation issues before completing";return}await p.saveConfiguration();const C=p.exportConfiguration();_("complete",C),s()?.(C)}function O(){p.canProceedToStep(p.currentStep+1)?p.nextStep():p.currentStep===0&&p.selectedCount===0?p.error="Please select at least one option":p.currentStep===1&&!p.isValid&&(p.error="Please resolve validation issues")}function M(){p.previousStep()}function A(C){p.goToStep(C)}const x=p;var T=Wo(),I=a(T);return Cs(I,{children:(C,se)=>{var re=vt(),ne=Ke(re);{var Pe=V=>{var j=ko(),_e=a(j);ai(_e,{size:"large",message:"Loading configuration model..."}),f(V,j)},Ae=(V,j)=>{{var _e=ce=>{var ke=Ao(),Oe=a(ke),P=u(a(Oe),4),X=a(P),L=u(P,2);L.__click=[Eo],k(()=>y(X,p.error)),f(ce,ke)},Le=(ce,ke)=>{{var Oe=P=>{var X=Yo(),L=a(X),E=a(L),R=a(E),ve=a(R),B=u(R,2);{var Y=F=>{var W=Co(),U=a(W);k(()=>y(U,p.model.description)),f(F,W)};m(B,F=>{p.model.description&&F(Y)})}var be=u(E,2),Ve=a(be);{var Ne=F=>{var W=Io();W.__click=[xo,b];var U=a(W);k(()=>y(U,`⚠️ ${(p.validationResults?.violations?.length||0)??""} Issues`)),f(F,W)};m(Ve,F=>{p.hasViolations&&F(Ne)})}var ut=u(Ve,2);{var ct=F=>{var W=To(),U=a(W);ai(U,{size:"small"}),f(F,W)},Et=(F,W)=>{{var U=Q=>{var $=Po(),oe=a($);k(q=>y(oe,`✅ Saved ${q??""}`),[()=>new Date(p.lastSaved).toLocaleTimeString()]),f(Q,$)};m(F,Q=>{p.lastSaved&&Q(U)},W)}};m(ut,F=>{p.isSaving?F(ct):F(Et,!1)})}var mt=u(L,2);ys(mt,{get steps(){return g},get currentStep(){return p.currentStep},onStepClick:A,canNavigate:!0});var Re=u(mt,2),ae=a(Re);{var qe=F=>{var W=Mo(),U=u(a(W),2);{var Q=he=>{var J=Do();Ue(J,21,()=>p.safeGroups,ie=>ie.id,(ie,ge)=>{const pe=me(()=>p.safeOptions.filter(fe=>fe.group_id===o(ge).id)),te=me(()=>p.isGroupExpanded(o(ge).id));oa(ie,{get group(){return o(ge)},get options(){return o(pe)},get selections(){return p.selections},get availableOptions(){return p.availableOptions},onSelectionChange:(fe,ze)=>p.updateSelection(fe,ze),get expanded(){return o(te)},onToggle:()=>p.toggleGroup(o(ge).id)})}),f(he,J)},$=(he,J)=>{{var ie=pe=>{var te=Oo(),fe=a(te);ai(fe,{size:"medium",message:"Loading options..."}),f(pe,te)},ge=pe=>{var te=qo();f(pe,te)};m(he,pe=>{p.isLoading?pe(ie):pe(ge,!1)},J)}};m(U,he=>{p.safeGroups.length>0?he(Q):he($,!1)})}var oe=u(U,2),q=a(oe),K=a(q),de=a(K),Ee=u(K,2);{var ee=he=>{var J=Ro(),ie=a(J);k(ge=>y(ie,`${ge??""}% complete`),[()=>Math.round(p.progress)]),f(he,J)};m(Ee,he=>{p.progress>0&&he(ee)})}var le=u(q,2);le.__click=O,k(()=>{y(de,`${p.selectedCount??""} options selected`),le.disabled=p.selectedCount===0}),f(F,W)},D=(F,W)=>{{var U=$=>{var oe=Lo(),q=u(a(oe),2);zr(q,{get validationResults(){return p.validationResults},onFix:J=>{J.action==="add"?p.updateSelection(J.option_id,J.quantity||1):J.action==="remove"&&p.updateSelection(J.option_id,0)}});var K=u(q,2);{var de=J=>{var ie=Vo(),ge=a(ie);ai(ge,{size:"small",message:"Validating configuration..."}),f(J,ie)};m(K,J=>{p.isValidating&&J(de)})}var Ee=u(K,2),ee=a(Ee);ee.__click=M;var le=u(ee,2);le.__click=O;var he=a(le);k(()=>{le.disabled=!p.isValid,y(he,p.isValid?"Continue to Pricing":"Resolve Issues First")}),f($,oe)},Q=($,oe)=>{{var q=de=>{var Ee=zo(),ee=u(a(Ee),2);Ta(ee,{get pricingData(){return p.pricingData},get selections(){return p.selections},get options(){return p.options},get volumeTiers(){return p.volumeTiers},detailed:!0});var le=u(ee,2);{var he=pe=>{var te=No(),fe=a(te);ai(fe,{size:"small",message:"Calculating pricing..."}),f(pe,te)};m(le,pe=>{p.isPricing&&pe(he)})}var J=u(le,2),ie=a(J);ie.__click=M;var ge=u(ie,2);ge.__click=O,f(de,Ee)},K=(de,Ee)=>{{var ee=le=>{var he=Fo(),J=u(a(he),2);const ie=me(()=>p.exportConfiguration());So(J,{get configuration(){return o(ie)},get model(){return p.model},onEdit:ze=>A(ze)});var ge=u(J,2),pe=a(ge);pe.__click=M;var te=u(pe,2);te.__click=w;var fe=a(te);k(()=>{te.disabled=p.isSaving,y(fe,p.isSaving?"Saving...":"Complete Configuration")}),f(le,he)};m(de,le=>{p.currentStep===3&&le(ee)},Ee)}};m($,de=>{p.currentStep===2?de(q):de(K,!1)},oe)}};m(F,$=>{p.currentStep===1?$(U):$(Q,!1)},W)}};m(ae,F=>{p.currentStep===0?F(qe):F(D,!1)})}var G=u(Re,2);{var ue=F=>{var W=jo();let U;var Q=a(W),$=u(a(Q),2);$.__click=[Uo,b];var oe=u(Q,2);zr(oe,{get validationResults(){return p.validationResults},compact:!0,onFix:q=>{q.action==="add"?p.updateSelection(q.option_id,q.quantity||1):q.action==="remove"&&p.updateSelection(q.option_id,0),z(b,!1)}}),k(q=>U=xe(W,1,"validation-panel svelte-7b7116",null,U,q),[()=>({open:o(b)})]),f(F,W)};m(G,F=>{o(b)&&p.hasViolations&&F(ue)})}var ye=u(G,2);{var De=F=>{var W=Qo(),U=a(W),Q=u(a(U),2),$=u(a(Q),2),oe=a($),q=u(Q,2),K=u(a(q),2),de=a(K),Ee=u(q,2);{var ee=te=>{var fe=Go(),ze=u(a(fe),2),nt=a(ze);k(()=>y(nt,p.discounts.length)),f(te,fe)};m(Ee,te=>{p.discounts.length>0&&te(ee)})}var le=u(Ee,2),he=u(a(le),2);let J;var ie=a(he),ge=u(U,2);{var pe=te=>{var fe=Ho(),ze=u(a(fe),2);Ue(ze,21,()=>Object.entries(p.selections),Qe,(nt,Ji)=>{var dt=me(()=>Di(o(Ji),2));let At=()=>o(dt)[0],Ur=()=>o(dt)[1];var jr=vt();const Gr=me(()=>p.safeOptions.find(oi=>oi.id===At()));var Zo=Ke(jr);{var Xo=oi=>{var Br=Bo(),Hr=a(Br),$o=a(Hr),el=u(Hr,2),tl=a(el);k(()=>{y($o,o(Gr).name),y(tl,`×${Ur()??""}`)}),f(oi,Br)};m(Zo,oi=>{o(Gr)&&Ur()>0&&oi(Xo)})}f(nt,jr)}),f(te,fe)};m(ge,te=>{p.selectedCount>0&&te(pe)})}k((te,fe)=>{y(oe,p.selectedCount),y(de,`$${te??""}`),J=xe(he,1,"svelte-7b7116",null,J,fe),y(ie,p.isValid?"✅ Valid":"⚠️ Issues")},[()=>p.totalPrice.toFixed(2),()=>({valid:p.isValid,invalid:!p.isValid})]),f(F,W)};m(ye,F=>{n()||F(De)})}k(()=>y(ve,p.model.name)),f(P,X)};m(ce,P=>{o(S)&&p.model&&P(Oe)},ke)}};m(V,ce=>{p.error&&!p.model?ce(_e):ce(Le,!1)},j)}};m(ne,V=>{p.isLoading&&!o(S)?V(Pe):V(Ae,!1)})}f(C,re)},$$slots:{default:!0}}),k(()=>{xe(T,1,`configurator-app ${n()?"embed-mode":"standalone-mode"}`,"svelte-7b7116"),pt(T,"data-theme",i())}),f(t,T),et({store:x})}ht(["click"]);class Ki{constructor(e,i={}){this.element=e,this.options=i,this.app=null,this.store=p}mount(){return this.element.innerHTML="",this.app=Wn(Ko,{target:this.element,props:{modelId:this.options.modelId,apiUrl:this.options.apiUrl||"/api/v1",theme:this.options.theme||"light",embedMode:this.options.embedMode!==!1,configurationId:this.options.configurationId,onComplete:this.options.onComplete,onConfigurationChange:this.options.onConfigurationChange,onError:this.options.onError}}),this}destroy(){this.app&&(this.app.$destroy(),this.app=null),this.store.reset()}updateModel(e){this.app&&this.store.setModelId(e)}updateTheme(e){this.app&&document.documentElement.setAttribute("data-theme",e)}getConfiguration(){return this.store.exportConfiguration()}async loadConfiguration(e){return this.store.loadConfiguration(e)}reset(){this.store.reset()}nextStep(){this.store.nextStep()}previousStep(){this.store.previousStep()}goToStep(e){this.store.goToStep(e)}updateSelection(e,i){this.store.updateSelection(e,i)}getSelections(){return this.store.selections}async validate(){return this.store.validateSelections()}isValid(){return this.store.isValid}getValidationResults(){return this.store.validationResults}async calculatePricing(e={}){return this.store.calculatePricing(e)}getPricingData(){return this.store.pricingData}getTotalPrice(){return this.store.totalPrice}}window.CPQConfigurator={create:function(t,e={}){if(!t)throw new Error("Container element is required");if(!e.modelId)throw new Error("Model ID is required");const i=typeof t=="string"?document.querySelector(t):t;if(!i)throw new Error("Container element not found");const r=new Ki(i,e);return r.mount(),r},version:"1.0.0",Widget:Ki,Store:p},document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-cpq-auto-init]").forEach(e=>{const i=e.getAttribute("data-model-id"),r=e.getAttribute("data-api-url"),n=e.getAttribute("data-theme"),s=e.getAttribute("data-config-id");if(i)try{const l=window.CPQConfigurator.create(e,{modelId:i,apiUrl:r,theme:n,configurationId:s,embedMode:!0,onComplete:v=>{e.dispatchEvent(new CustomEvent("cpq:complete",{detail:v,bubbles:!0}))},onConfigurationChange:v=>{e.dispatchEvent(new CustomEvent("cpq:change",{detail:v,bubbles:!0}))},onError:v=>{e.dispatchEvent(new CustomEvent("cpq:error",{detail:v,bubbles:!0}))}});e.__cpqWidget=l}catch(l){console.error("Failed to auto-initialize CPQ widget:",l)}})});const Jo=window.CPQConfigurator;Te.CPQWidget=Ki,Te.configStore=p,Te.default=Jo,Object.defineProperties(Te,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
